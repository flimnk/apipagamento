2025-11-21 14:11:38 INFO  [background-preinit] org.hibernate.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.3.Final
2025-11-21 14:11:38 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Starting FiadoPayApplication using Java 21.0.8 with PID 10764 (/home/andre/Documents/fiadopay-main/target/classes started by andre in /home/andre/Documents/fiadopay-main)
2025-11-21 14:11:38 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-21 14:11:38 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-11-21 14:11:38 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-11-21 14:11:39 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-21 14:11:39 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 45 ms. Found 4 JPA repository interfaces.
2025-11-21 14:11:39 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-21 14:11:39 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-11-21 14:11:39 INFO  [restartedMain] org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-11-21 14:11:39 INFO  [restartedMain] org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-21 14:11:39 INFO  [restartedMain] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-11-21 14:11:39 INFO  [restartedMain] org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1613 ms
2025-11-21 14:11:40 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-21 14:11:40 INFO  [restartedMain] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:fiadopay user=SA
2025-11-21 14:11:40 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-11-21 14:11:40 INFO  [restartedMain] org.hibernate.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-21 14:11:40 INFO  [restartedMain] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.33.Final
2025-11-21 14:11:40 INFO  [restartedMain] org.hibernate.cache.internal.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-21 14:11:40 INFO  [restartedMain] org.springframework.orm.jpa.persistenceunit.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-21 14:11:40 INFO  [restartedMain] org.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-21 14:11:41 INFO  [restartedMain] org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-21 14:11:41 INFO  [restartedMain] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 14:11:41 INFO  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-11-21 14:11:41 WARN  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-11-21 14:11:41 WARN  [restartedMain] org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-21 14:11:42 INFO  [restartedMain] org.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:fiadopay'
2025-11-21 14:11:42 INFO  [restartedMain] org.springframework.boot.devtools.autoconfigure.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-21 14:11:42 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-11-21 14:11:42 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-11-21 14:11:42 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Started FiadoPayApplication in 5.178 seconds (process running for 5.651)
2025-11-21 14:14:22 INFO  [http-nio-8080-exec-2] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-21 14:14:22 INFO  [http-nio-8080-exec-2] org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-21 14:14:22 INFO  [http-nio-8080-exec-2] org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-11-21 14:14:32 INFO  [http-nio-8080-exec-7] edu.ucsal.fiadopay.service.payment.PaymentService - Iniciando criação de pagamento merchantId=1 idemKey=123e4567-e89b-12d3-a456-426614174000 method=CARD amount=19990.50
2025-11-21 14:14:32 INFO  [http-nio-8080-exec-7] edu.ucsal.fiadopay.service.payment.PaymentService - Pagamento criado com sucesso paymentId=pay_efd77589-e0d8-4055-84fa-c518558d3fa0 status=PENDING
2025-11-21 14:14:32 INFO  [pool-2-thread-1] edu.ucsal.fiadopay.service.payment.PaymentService - Processando webhook para paymentId=pay_efd77589-e0d8-4055-84fa-c518558d3fa0
2025-11-21 14:14:33 INFO  [pool-2-thread-1] edu.ucsal.fiadopay.service.payment.PaymentService - Agendando entrega de webhook eventId=evt_6f7713b5 paymentId=pay_efd77589-e0d8-4055-84fa-c518558d3fa0 url=http://localhost:8081/webhooks/payments
2025-11-21 14:14:34 WARN  [http-nio-8080-exec-8] edu.ucsal.fiadopay.service.payment.PaymentService - Tentativa de acesso não autorizado paymentId=pay_86558356-d97d-4e7a-b778-34deec2bb9c6 merchantId=1
2025-11-21 14:14:34 WARN  [http-nio-8080-exec-8] org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.server.ResponseStatusException: 403 FORBIDDEN "Payment does not exist or does not belong to this merchant."]
2025-11-21 14:17:23 WARN  [http-nio-8080-exec-4] org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.server.ResponseStatusException: 409 CONFLICT "Merchant name or  webHook   already exists"]
2025-11-21 14:17:42 WARN  [http-nio-8080-exec-5] org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.server.ResponseStatusException: 409 CONFLICT "Merchant name or  webHook   already exists"]
2025-11-21 14:33:26 INFO  [SpringApplicationShutdownHook] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-21 14:33:26 INFO  [tomcat-shutdown] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-21 14:33:26 INFO  [SpringApplicationShutdownHook] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 14:33:26 WARN  [SpringApplicationShutdownHook] org.springframework.beans.factory.support.DisposableBeanAdapter - Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2025-11-21 14:33:26 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-11-21 14:33:26 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-11-21 14:33:30 INFO  [background-preinit] org.hibernate.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.3.Final
2025-11-21 14:33:30 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Starting FiadoPayApplication using Java 21.0.8 with PID 12460 (/home/andre/Documents/fiadopay-main/target/classes started by andre in /home/andre/Documents/fiadopay-main)
2025-11-21 14:33:30 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-21 14:33:30 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-11-21 14:33:30 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-11-21 14:33:31 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-21 14:33:31 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 55 ms. Found 4 JPA repository interfaces.
2025-11-21 14:33:32 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-21 14:33:32 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-11-21 14:33:32 INFO  [restartedMain] org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-11-21 14:33:32 INFO  [restartedMain] org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-21 14:33:32 INFO  [restartedMain] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-11-21 14:33:32 INFO  [restartedMain] org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1821 ms
2025-11-21 14:33:32 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-21 14:33:32 INFO  [restartedMain] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:fiadopay user=SA
2025-11-21 14:33:32 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-11-21 14:33:32 INFO  [restartedMain] org.hibernate.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-21 14:33:32 INFO  [restartedMain] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.33.Final
2025-11-21 14:33:32 INFO  [restartedMain] org.hibernate.cache.internal.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-21 14:33:32 INFO  [restartedMain] org.springframework.orm.jpa.persistenceunit.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-21 14:33:32 INFO  [restartedMain] org.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-21 14:33:33 INFO  [restartedMain] org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-21 14:33:33 INFO  [restartedMain] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 14:33:33 INFO  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-11-21 14:33:33 WARN  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-11-21 14:33:34 WARN  [restartedMain] org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-21 14:33:34 INFO  [restartedMain] org.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:fiadopay'
2025-11-21 14:33:34 INFO  [restartedMain] org.springframework.boot.devtools.autoconfigure.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-21 14:33:34 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-11-21 14:33:34 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-11-21 14:33:34 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Started FiadoPayApplication in 4.863 seconds (process running for 5.294)
2025-11-21 14:34:46 INFO  [http-nio-8080-exec-2] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-21 14:34:46 INFO  [http-nio-8080-exec-2] org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-21 14:34:46 INFO  [http-nio-8080-exec-2] org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-11-21 14:34:55 INFO  [http-nio-8080-exec-4] edu.ucsal.fiadopay.service.payment.PaymentService - Iniciando criação de pagamento merchantId=1 idemKey=123e4567-e89b-12d3-a456-426614174000 method=CARD amount=19990.50
2025-11-21 14:34:56 INFO  [http-nio-8080-exec-4] edu.ucsal.fiadopay.service.payment.PaymentService - Pagamento criado com sucesso paymentId=pay_a51bcec0-495d-4aee-9302-cf5b11ece8a6 status=PENDING
2025-11-21 14:34:56 INFO  [pool-2-thread-1] edu.ucsal.fiadopay.service.payment.PaymentService - Processando webhook para paymentId=pay_a51bcec0-495d-4aee-9302-cf5b11ece8a6
2025-11-21 14:34:56 INFO  [http-nio-8080-exec-4] edu.ucsal.fiadopay.annotations.logged.LogAspect - [] Executado em 24ms | args=[edu.ucsal.fiadopay.domain.merchant.Merchant@1d5b315c, 123e4567-e89b-12d3-a456-426614174000, PaymentRequest[method=CARD, currency=BRL, amount=19990.50, metadataOrderId=order-123, details={installments=3}]]
2025-11-21 14:34:57 INFO  [pool-2-thread-1] edu.ucsal.fiadopay.service.payment.PaymentService - Agendando entrega de webhook eventId=evt_b025cec6 paymentId=pay_a51bcec0-495d-4aee-9302-cf5b11ece8a6 url=http://localhost:8081/webhooks/payments
2025-11-21 14:35:07 WARN  [http-nio-8080-exec-8] edu.ucsal.fiadopay.service.payment.PaymentService - Tentativa de acesso não autorizado paymentId=pay_efd77589-e0d8-4055-84fa-c518558d3fa0 merchantId=1
2025-11-21 14:35:07 WARN  [http-nio-8080-exec-8] org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.server.ResponseStatusException: 403 FORBIDDEN "Payment does not exist or does not belong to this merchant."]
2025-11-21 14:36:09 INFO  [SpringApplicationShutdownHook] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-21 14:36:09 INFO  [tomcat-shutdown] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-21 14:36:09 INFO  [SpringApplicationShutdownHook] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 14:36:09 WARN  [SpringApplicationShutdownHook] org.springframework.beans.factory.support.DisposableBeanAdapter - Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2025-11-21 14:36:09 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-11-21 14:36:09 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-11-21 14:36:12 INFO  [background-preinit] org.hibernate.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.3.Final
2025-11-21 14:36:12 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Starting FiadoPayApplication using Java 21.0.8 with PID 12716 (/home/andre/Documents/fiadopay-main/target/classes started by andre in /home/andre/Documents/fiadopay-main)
2025-11-21 14:36:12 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-21 14:36:12 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-11-21 14:36:12 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-11-21 14:36:13 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-21 14:36:13 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 48 ms. Found 4 JPA repository interfaces.
2025-11-21 14:36:14 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-21 14:36:14 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-11-21 14:36:14 INFO  [restartedMain] org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-11-21 14:36:14 INFO  [restartedMain] org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-21 14:36:14 INFO  [restartedMain] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-11-21 14:36:14 INFO  [restartedMain] org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1590 ms
2025-11-21 14:36:14 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-21 14:36:14 INFO  [restartedMain] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:fiadopay user=SA
2025-11-21 14:36:14 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-11-21 14:36:14 INFO  [restartedMain] org.hibernate.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-21 14:36:14 INFO  [restartedMain] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.33.Final
2025-11-21 14:36:14 INFO  [restartedMain] org.hibernate.cache.internal.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-21 14:36:14 INFO  [restartedMain] org.springframework.orm.jpa.persistenceunit.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-21 14:36:14 INFO  [restartedMain] org.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-21 14:36:15 INFO  [restartedMain] org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-21 14:36:15 INFO  [restartedMain] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 14:36:15 INFO  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-11-21 14:36:15 WARN  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-11-21 14:36:16 WARN  [restartedMain] org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-21 14:36:16 INFO  [restartedMain] org.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:fiadopay'
2025-11-21 14:36:16 INFO  [restartedMain] org.springframework.boot.devtools.autoconfigure.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-21 14:36:16 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-11-21 14:36:16 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-11-21 14:36:16 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Started FiadoPayApplication in 4.776 seconds (process running for 5.165)
2025-11-21 14:36:27 INFO  [http-nio-8080-exec-1] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-21 14:36:27 INFO  [http-nio-8080-exec-1] org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-21 14:36:27 INFO  [http-nio-8080-exec-1] org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-11-21 14:36:32 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.service.payment.PaymentService - Iniciando criação de pagamento merchantId=1 idemKey=123e4567-e89b-12d3-a456-426614174000 method=CARD amount=19990.50
2025-11-21 14:36:32 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.service.payment.PaymentService - Pagamento criado com sucesso paymentId=pay_eb6287b6-300b-4bb8-8a0e-079c63a886de status=PENDING
2025-11-21 14:36:32 INFO  [pool-2-thread-1] edu.ucsal.fiadopay.service.payment.PaymentService - Processando webhook para paymentId=pay_eb6287b6-300b-4bb8-8a0e-079c63a886de
2025-11-21 14:36:34 INFO  [pool-2-thread-1] edu.ucsal.fiadopay.service.payment.PaymentService - Agendando entrega de webhook eventId=evt_65f42a07 paymentId=pay_eb6287b6-300b-4bb8-8a0e-079c63a886de url=http://localhost:8081/webhooks/payments
2025-11-21 14:36:35 WARN  [http-nio-8080-exec-7] edu.ucsal.fiadopay.service.payment.PaymentService - Tentativa de acesso não autorizado paymentId=pay_efd77589-e0d8-4055-84fa-c518558d3fa0 merchantId=1
2025-11-21 14:36:35 WARN  [http-nio-8080-exec-7] org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.server.ResponseStatusException: 403 FORBIDDEN "Payment does not exist or does not belong to this merchant."]
2025-11-21 14:36:42 WARN  [http-nio-8080-exec-8] edu.ucsal.fiadopay.service.payment.PaymentService - Tentativa de acesso não autorizado paymentId=pay_efd77589-e0d8-4055-84fa-c518558d3fa0 merchantId=1
2025-11-21 14:36:42 WARN  [http-nio-8080-exec-8] org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.server.ResponseStatusException: 403 FORBIDDEN "Payment does not exist or does not belong to this merchant."]
2025-11-21 14:39:41 INFO  [SpringApplicationShutdownHook] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-21 14:39:41 INFO  [tomcat-shutdown] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-21 14:39:41 INFO  [SpringApplicationShutdownHook] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 14:39:41 WARN  [SpringApplicationShutdownHook] org.springframework.beans.factory.support.DisposableBeanAdapter - Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2025-11-21 14:39:41 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-11-21 14:39:41 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-11-21 14:39:44 INFO  [background-preinit] org.hibernate.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.3.Final
2025-11-21 14:39:44 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Starting FiadoPayApplication using Java 21.0.8 with PID 12921 (/home/andre/Documents/fiadopay-main/target/classes started by andre in /home/andre/Documents/fiadopay-main)
2025-11-21 14:39:44 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-21 14:39:44 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-11-21 14:39:44 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-11-21 14:39:45 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-21 14:39:45 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 47 ms. Found 4 JPA repository interfaces.
2025-11-21 14:39:46 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-21 14:39:46 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-11-21 14:39:46 INFO  [restartedMain] org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-11-21 14:39:46 INFO  [restartedMain] org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-21 14:39:46 INFO  [restartedMain] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-11-21 14:39:46 INFO  [restartedMain] org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1824 ms
2025-11-21 14:39:46 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-21 14:39:46 INFO  [restartedMain] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:fiadopay user=SA
2025-11-21 14:39:46 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-11-21 14:39:46 INFO  [restartedMain] org.hibernate.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-21 14:39:46 INFO  [restartedMain] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.33.Final
2025-11-21 14:39:46 INFO  [restartedMain] org.hibernate.cache.internal.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-21 14:39:47 INFO  [restartedMain] org.springframework.orm.jpa.persistenceunit.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-21 14:39:47 INFO  [restartedMain] org.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-21 14:39:47 INFO  [restartedMain] org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-21 14:39:47 INFO  [restartedMain] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 14:39:48 INFO  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-11-21 14:39:48 WARN  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-11-21 14:39:48 WARN  [restartedMain] org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-21 14:39:48 INFO  [restartedMain] org.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:fiadopay'
2025-11-21 14:39:48 INFO  [restartedMain] org.springframework.boot.devtools.autoconfigure.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-21 14:39:49 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-11-21 14:39:49 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-11-21 14:39:49 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Started FiadoPayApplication in 5.175 seconds (process running for 5.558)
2025-11-21 14:40:03 INFO  [SpringApplicationShutdownHook] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-21 14:40:03 INFO  [tomcat-shutdown] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-21 14:40:03 INFO  [SpringApplicationShutdownHook] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 14:40:03 WARN  [SpringApplicationShutdownHook] org.springframework.beans.factory.support.DisposableBeanAdapter - Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2025-11-21 14:40:03 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-11-21 14:40:03 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-11-21 14:40:05 INFO  [background-preinit] org.hibernate.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.3.Final
2025-11-21 14:40:06 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Starting FiadoPayApplication using Java 21.0.8 with PID 13032 (/home/andre/Documents/fiadopay-main/target/classes started by andre in /home/andre/Documents/fiadopay-main)
2025-11-21 14:40:06 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-21 14:40:06 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-11-21 14:40:06 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-11-21 14:40:07 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-21 14:40:07 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 84 ms. Found 4 JPA repository interfaces.
2025-11-21 14:40:07 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-21 14:40:07 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-11-21 14:40:07 INFO  [restartedMain] org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-11-21 14:40:07 INFO  [restartedMain] org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-21 14:40:07 INFO  [restartedMain] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-11-21 14:40:07 INFO  [restartedMain] org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1802 ms
2025-11-21 14:40:07 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-21 14:40:08 INFO  [restartedMain] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:fiadopay user=SA
2025-11-21 14:40:08 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-11-21 14:40:08 INFO  [restartedMain] org.hibernate.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-21 14:40:08 INFO  [restartedMain] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.33.Final
2025-11-21 14:40:08 INFO  [restartedMain] org.hibernate.cache.internal.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-21 14:40:08 INFO  [restartedMain] org.springframework.orm.jpa.persistenceunit.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-21 14:40:08 INFO  [restartedMain] org.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-21 14:40:09 INFO  [restartedMain] org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-21 14:40:09 INFO  [restartedMain] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 14:40:10 INFO  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-11-21 14:40:10 WARN  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-11-21 14:40:10 WARN  [restartedMain] org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-21 14:40:10 INFO  [restartedMain] org.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:fiadopay'
2025-11-21 14:40:10 INFO  [restartedMain] org.springframework.boot.devtools.autoconfigure.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-21 14:40:10 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-11-21 14:40:10 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-11-21 14:40:10 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Started FiadoPayApplication in 5.523 seconds (process running for 5.929)
2025-11-21 14:40:46 INFO  [http-nio-8080-exec-2] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-21 14:40:46 INFO  [http-nio-8080-exec-2] org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-21 14:40:46 INFO  [http-nio-8080-exec-2] org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-11-21 14:40:53 INFO  [http-nio-8080-exec-7] edu.ucsal.fiadopay.service.payment.PaymentService - Iniciando criação de pagamento merchantId=1 idemKey=123e4567-e89b-12d3-a456-426614174000 method=CARD amount=19990.50
2025-11-21 14:40:53 INFO  [http-nio-8080-exec-7] edu.ucsal.fiadopay.service.payment.PaymentService - Pagamento criado com sucesso paymentId=pay_9bb54586-2f3e-4b92-85a3-ec236fc43a99 status=PENDING
2025-11-21 14:40:53 INFO  [pool-2-thread-1] edu.ucsal.fiadopay.service.payment.PaymentService - Processando webhook para paymentId=pay_9bb54586-2f3e-4b92-85a3-ec236fc43a99
2025-11-21 14:40:55 INFO  [pool-2-thread-1] edu.ucsal.fiadopay.service.payment.PaymentService - Agendando entrega de webhook eventId=evt_600b7b86 paymentId=pay_9bb54586-2f3e-4b92-85a3-ec236fc43a99 url=http://localhost:8081/webhooks/payments
2025-11-21 14:40:55 WARN  [http-nio-8080-exec-8] edu.ucsal.fiadopay.service.payment.PaymentService - Tentativa de acesso não autorizado paymentId=pay_efd77589-e0d8-4055-84fa-c518558d3fa0 merchantId=1
2025-11-21 14:40:55 WARN  [http-nio-8080-exec-8] org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.server.ResponseStatusException: 403 FORBIDDEN "Payment does not exist or does not belong to this merchant."]
2025-11-21 14:41:23 INFO  [SpringApplicationShutdownHook] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-21 14:41:23 INFO  [tomcat-shutdown] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-21 14:41:23 INFO  [SpringApplicationShutdownHook] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 14:41:23 WARN  [SpringApplicationShutdownHook] org.springframework.beans.factory.support.DisposableBeanAdapter - Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2025-11-21 14:41:23 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-11-21 14:41:23 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-11-21 14:41:26 INFO  [background-preinit] org.hibernate.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.3.Final
2025-11-21 14:41:26 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Starting FiadoPayApplication using Java 21.0.8 with PID 13185 (/home/andre/Documents/fiadopay-main/target/classes started by andre in /home/andre/Documents/fiadopay-main)
2025-11-21 14:41:26 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-21 14:41:26 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-11-21 14:41:26 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-11-21 14:41:27 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-21 14:41:27 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 49 ms. Found 4 JPA repository interfaces.
2025-11-21 14:41:27 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-21 14:41:27 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-11-21 14:41:27 INFO  [restartedMain] org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-11-21 14:41:27 INFO  [restartedMain] org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-21 14:41:27 INFO  [restartedMain] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-11-21 14:41:28 INFO  [restartedMain] org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1709 ms
2025-11-21 14:41:28 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-21 14:41:28 INFO  [restartedMain] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:fiadopay user=SA
2025-11-21 14:41:28 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-11-21 14:41:28 INFO  [restartedMain] org.hibernate.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-21 14:41:28 INFO  [restartedMain] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.33.Final
2025-11-21 14:41:28 INFO  [restartedMain] org.hibernate.cache.internal.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-21 14:41:28 INFO  [restartedMain] org.springframework.orm.jpa.persistenceunit.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-21 14:41:28 INFO  [restartedMain] org.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-21 14:41:29 INFO  [restartedMain] org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-21 14:41:29 INFO  [restartedMain] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 14:41:29 INFO  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-11-21 14:41:29 WARN  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-11-21 14:41:29 WARN  [restartedMain] org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-21 14:41:30 INFO  [restartedMain] org.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:fiadopay'
2025-11-21 14:41:30 INFO  [restartedMain] org.springframework.boot.devtools.autoconfigure.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-21 14:41:30 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-11-21 14:41:30 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-11-21 14:41:30 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Started FiadoPayApplication in 4.879 seconds (process running for 5.277)
2025-11-21 14:42:17 INFO  [http-nio-8080-exec-2] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-21 14:42:17 INFO  [http-nio-8080-exec-2] org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-21 14:42:17 INFO  [http-nio-8080-exec-2] org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-11-21 14:42:22 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.service.payment.PaymentService - Iniciando criação de pagamento merchantId=1 idemKey=123e4567-e89b-12d3-a456-426614174000 method=CARD amount=19990.50
2025-11-21 14:42:22 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.service.payment.PaymentService - Pagamento criado com sucesso paymentId=pay_3aa478ae-b178-49dc-9098-897987539cb3 status=PENDING
2025-11-21 14:42:22 INFO  [pool-2-thread-1] edu.ucsal.fiadopay.service.payment.PaymentService - Processando webhook para paymentId=pay_3aa478ae-b178-49dc-9098-897987539cb3
2025-11-21 14:42:24 WARN  [http-nio-8080-exec-7] edu.ucsal.fiadopay.service.payment.PaymentService - Tentativa de acesso não autorizado paymentId=pay_efd77589-e0d8-4055-84fa-c518558d3fa0 merchantId=1
2025-11-21 14:42:24 WARN  [http-nio-8080-exec-7] org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.server.ResponseStatusException: 403 FORBIDDEN "Payment does not exist or does not belong to this merchant."]
2025-11-21 14:42:24 INFO  [pool-2-thread-1] edu.ucsal.fiadopay.service.payment.PaymentService - Agendando entrega de webhook eventId=evt_4d4adb1b paymentId=pay_3aa478ae-b178-49dc-9098-897987539cb3 url=http://localhost:8081/webhooks/payments
2025-11-21 14:43:29 INFO  [SpringApplicationShutdownHook] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-21 14:43:29 INFO  [tomcat-shutdown] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-21 14:43:29 INFO  [SpringApplicationShutdownHook] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 14:43:29 WARN  [SpringApplicationShutdownHook] org.springframework.beans.factory.support.DisposableBeanAdapter - Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2025-11-21 14:43:29 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-11-21 14:43:29 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-11-21 14:43:32 INFO  [background-preinit] org.hibernate.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.3.Final
2025-11-21 14:43:32 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Starting FiadoPayApplication using Java 21.0.8 with PID 13350 (/home/andre/Documents/fiadopay-main/target/classes started by andre in /home/andre/Documents/fiadopay-main)
2025-11-21 14:43:32 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-21 14:43:32 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-11-21 14:43:32 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-11-21 14:43:34 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-21 14:43:34 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 67 ms. Found 4 JPA repository interfaces.
2025-11-21 14:43:35 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-21 14:43:35 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-11-21 14:43:35 INFO  [restartedMain] org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-11-21 14:43:35 INFO  [restartedMain] org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-21 14:43:35 INFO  [restartedMain] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-11-21 14:43:35 INFO  [restartedMain] org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2236 ms
2025-11-21 14:43:35 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-21 14:43:35 INFO  [restartedMain] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:fiadopay user=SA
2025-11-21 14:43:35 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-11-21 14:43:35 INFO  [restartedMain] org.hibernate.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-21 14:43:35 INFO  [restartedMain] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.33.Final
2025-11-21 14:43:35 INFO  [restartedMain] org.hibernate.cache.internal.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-21 14:43:35 INFO  [restartedMain] org.springframework.orm.jpa.persistenceunit.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-21 14:43:35 INFO  [restartedMain] org.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-21 14:43:36 INFO  [restartedMain] org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-21 14:43:36 INFO  [restartedMain] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 14:43:37 INFO  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-11-21 14:43:37 WARN  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-11-21 14:43:37 WARN  [restartedMain] org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-21 14:43:38 INFO  [restartedMain] org.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:fiadopay'
2025-11-21 14:43:38 INFO  [restartedMain] org.springframework.boot.devtools.autoconfigure.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-21 14:43:38 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-11-21 14:43:38 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-11-21 14:43:38 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Started FiadoPayApplication in 6.428 seconds (process running for 6.815)
2025-11-21 14:43:39 INFO  [http-nio-8080-exec-2] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-21 14:43:39 INFO  [http-nio-8080-exec-2] org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-21 14:43:39 INFO  [http-nio-8080-exec-2] org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-11-21 14:43:44 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.service.payment.PaymentService - Iniciando criação de pagamento merchantId=1 idemKey=123e4567-e89b-12d3-a456-426614174000 method=CARD amount=19990.50
2025-11-21 14:43:44 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.service.payment.PaymentService - Pagamento criado com sucesso paymentId=pay_5b23b50b-5241-47f6-b995-e42fdd4cb73b status=PENDING
2025-11-21 14:43:44 INFO  [pool-2-thread-1] edu.ucsal.fiadopay.service.payment.PaymentService - Processando webhook para paymentId=pay_5b23b50b-5241-47f6-b995-e42fdd4cb73b
2025-11-21 14:43:45 WARN  [http-nio-8080-exec-7] edu.ucsal.fiadopay.service.payment.PaymentService - Tentativa de acesso não autorizado paymentId=pay_efd77589-e0d8-4055-84fa-c518558d3fa0 merchantId=1
2025-11-21 14:43:45 WARN  [http-nio-8080-exec-7] org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.server.ResponseStatusException: 403 FORBIDDEN "Payment does not exist or does not belong to this merchant."]
2025-11-21 14:43:45 INFO  [pool-2-thread-1] edu.ucsal.fiadopay.service.payment.PaymentService - Agendando entrega de webhook eventId=evt_53dd0823 paymentId=pay_5b23b50b-5241-47f6-b995-e42fdd4cb73b url=http://localhost:8081/webhooks/payments
2025-11-21 14:48:14 INFO  [SpringApplicationShutdownHook] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-21 14:48:14 INFO  [tomcat-shutdown] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-21 14:48:14 INFO  [SpringApplicationShutdownHook] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 14:48:14 WARN  [SpringApplicationShutdownHook] org.springframework.beans.factory.support.DisposableBeanAdapter - Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2025-11-21 14:48:14 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-11-21 14:48:14 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-11-21 14:48:17 INFO  [background-preinit] org.hibernate.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.3.Final
2025-11-21 14:48:17 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Starting FiadoPayApplication using Java 21.0.8 with PID 13523 (/home/andre/Documents/fiadopay-main/target/classes started by andre in /home/andre/Documents/fiadopay-main)
2025-11-21 14:48:17 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-21 14:48:17 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-11-21 14:48:17 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-11-21 14:48:18 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-21 14:48:18 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 55 ms. Found 4 JPA repository interfaces.
2025-11-21 14:48:19 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-21 14:48:19 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-11-21 14:48:19 INFO  [restartedMain] org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-11-21 14:48:19 INFO  [restartedMain] org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-21 14:48:19 INFO  [restartedMain] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-11-21 14:48:19 INFO  [restartedMain] org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1739 ms
2025-11-21 14:48:19 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-21 14:48:19 INFO  [restartedMain] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:fiadopay user=SA
2025-11-21 14:48:19 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-11-21 14:48:19 INFO  [restartedMain] org.hibernate.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-21 14:48:19 INFO  [restartedMain] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.33.Final
2025-11-21 14:48:19 INFO  [restartedMain] org.hibernate.cache.internal.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-21 14:48:20 INFO  [restartedMain] org.springframework.orm.jpa.persistenceunit.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-21 14:48:20 INFO  [restartedMain] org.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-21 14:48:21 INFO  [restartedMain] org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-21 14:48:21 INFO  [restartedMain] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 14:48:21 INFO  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-11-21 14:48:21 WARN  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-11-21 14:48:21 WARN  [restartedMain] org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-21 14:48:22 INFO  [restartedMain] org.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:fiadopay'
2025-11-21 14:48:22 INFO  [restartedMain] org.springframework.boot.devtools.autoconfigure.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-21 14:48:22 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-11-21 14:48:22 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-11-21 14:48:22 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Started FiadoPayApplication in 5.778 seconds (process running for 6.214)
2025-11-21 14:52:22 INFO  [http-nio-8080-exec-1] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-21 14:52:22 INFO  [http-nio-8080-exec-1] org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-21 14:52:22 INFO  [http-nio-8080-exec-1] org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-11-21 14:52:28 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.service.payment.PaymentService - Iniciando criação de pagamento merchantId=1 idemKey=123e4567-e89b-12d3-a456-426614174000 method=CARD amount=19990.50
2025-11-21 14:52:28 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.service.payment.PaymentService - Pagamento criado com sucesso paymentId=pay_aca40802-ece2-4786-810f-7eca69982eac status=PENDING
2025-11-21 14:52:28 INFO  [pool-2-thread-1] edu.ucsal.fiadopay.service.payment.PaymentService - Processando webhook para paymentId=pay_aca40802-ece2-4786-810f-7eca69982eac
2025-11-21 14:52:29 INFO  [pool-2-thread-1] edu.ucsal.fiadopay.service.payment.PaymentService - Agendando entrega de webhook eventId=evt_a6873e65 paymentId=pay_aca40802-ece2-4786-810f-7eca69982eac url=http://localhost:8081/webhooks/payments
2025-11-21 14:52:29 WARN  [http-nio-8080-exec-7] edu.ucsal.fiadopay.service.payment.PaymentService - Tentativa de acesso não autorizado paymentId=pay_efd77589-e0d8-4055-84fa-c518558d3fa0 merchantId=1
2025-11-21 14:52:29 WARN  [http-nio-8080-exec-7] org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.server.ResponseStatusException: 403 FORBIDDEN "Payment does not exist or does not belong to this merchant."]
2025-11-21 14:55:28 INFO  [SpringApplicationShutdownHook] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-21 14:55:28 INFO  [tomcat-shutdown] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-21 14:55:28 INFO  [SpringApplicationShutdownHook] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 14:55:28 WARN  [SpringApplicationShutdownHook] org.springframework.beans.factory.support.DisposableBeanAdapter - Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2025-11-21 14:55:28 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-11-21 14:55:28 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-11-21 14:55:32 INFO  [background-preinit] org.hibernate.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.3.Final
2025-11-21 14:55:32 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Starting FiadoPayApplication using Java 21.0.8 with PID 14064 (/home/andre/Documents/fiadopay-main/target/classes started by andre in /home/andre/Documents/fiadopay-main)
2025-11-21 14:55:32 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-21 14:55:32 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-11-21 14:55:32 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-11-21 14:55:33 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-21 14:55:34 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 97 ms. Found 4 JPA repository interfaces.
2025-11-21 14:55:35 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-21 14:55:35 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-11-21 14:55:35 INFO  [restartedMain] org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-11-21 14:55:35 INFO  [restartedMain] org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-21 14:55:35 INFO  [restartedMain] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-11-21 14:55:35 INFO  [restartedMain] org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2872 ms
2025-11-21 14:55:35 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-21 14:55:35 INFO  [restartedMain] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:fiadopay user=SA
2025-11-21 14:55:35 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-11-21 14:55:35 INFO  [restartedMain] org.hibernate.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-21 14:55:35 INFO  [restartedMain] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.33.Final
2025-11-21 14:55:35 INFO  [restartedMain] org.hibernate.cache.internal.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-21 14:55:36 INFO  [restartedMain] org.springframework.orm.jpa.persistenceunit.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-21 14:55:36 INFO  [restartedMain] org.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-21 14:55:37 INFO  [restartedMain] org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-21 14:55:37 INFO  [restartedMain] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 14:55:38 INFO  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-11-21 14:55:38 WARN  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-11-21 14:55:38 WARN  [restartedMain] org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-21 14:55:39 INFO  [restartedMain] org.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:fiadopay'
2025-11-21 14:55:39 INFO  [restartedMain] org.springframework.boot.devtools.autoconfigure.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-21 14:55:39 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-11-21 14:55:39 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-11-21 14:55:39 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Started FiadoPayApplication in 8.07 seconds (process running for 8.519)
2025-11-21 14:55:54 INFO  [http-nio-8080-exec-1] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-21 14:55:54 INFO  [http-nio-8080-exec-1] org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-21 14:55:54 INFO  [http-nio-8080-exec-1] org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-11-21 14:56:00 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.annotations.idempontent.IdempotencyAspect - Hiiiiiiiiiiiiiiiiiiiiiiiiiii
2025-11-21 14:56:00 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.annotations.validTransactionWindow.ValidTransactionWindowAspect - Olaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
2025-11-21 14:56:00 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.service.payment.PaymentService - Iniciando criação de pagamento merchantId=1 idemKey=123e4567-e89b-12d3-a456-426614174000 method=CARD amount=19990.50
2025-11-21 14:56:00 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.service.payment.PaymentService - Pagamento criado com sucesso paymentId=pay_764fe375-3d45-4d59-9e50-7ecc9d31eb58 status=PENDING
2025-11-21 14:56:00 INFO  [pool-2-thread-1] edu.ucsal.fiadopay.service.payment.PaymentService - Processando webhook para paymentId=pay_764fe375-3d45-4d59-9e50-7ecc9d31eb58
2025-11-21 14:56:01 INFO  [pool-2-thread-1] edu.ucsal.fiadopay.service.payment.PaymentService - Agendando entrega de webhook eventId=evt_098aabe4 paymentId=pay_764fe375-3d45-4d59-9e50-7ecc9d31eb58 url=http://localhost:8081/webhooks/payments
2025-11-21 14:56:53 INFO  [SpringApplicationShutdownHook] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-21 14:56:53 INFO  [tomcat-shutdown] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-21 14:56:53 INFO  [SpringApplicationShutdownHook] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 14:56:53 WARN  [SpringApplicationShutdownHook] org.springframework.beans.factory.support.DisposableBeanAdapter - Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2025-11-21 14:56:53 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-11-21 14:56:53 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-11-21 14:56:56 INFO  [background-preinit] org.hibernate.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.3.Final
2025-11-21 14:56:56 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Starting FiadoPayApplication using Java 21.0.8 with PID 14302 (/home/andre/Documents/fiadopay-main/target/classes started by andre in /home/andre/Documents/fiadopay-main)
2025-11-21 14:56:56 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-21 14:56:56 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-11-21 14:56:56 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-11-21 14:56:57 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-21 14:56:57 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 50 ms. Found 4 JPA repository interfaces.
2025-11-21 14:56:58 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-21 14:56:58 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-11-21 14:56:58 INFO  [restartedMain] org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-11-21 14:56:58 INFO  [restartedMain] org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-21 14:56:58 INFO  [restartedMain] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-11-21 14:56:58 INFO  [restartedMain] org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2090 ms
2025-11-21 14:56:58 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-21 14:56:58 INFO  [restartedMain] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:fiadopay user=SA
2025-11-21 14:56:58 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-11-21 14:56:59 INFO  [restartedMain] org.hibernate.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-21 14:56:59 INFO  [restartedMain] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.33.Final
2025-11-21 14:56:59 INFO  [restartedMain] org.hibernate.cache.internal.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-21 14:56:59 INFO  [restartedMain] org.springframework.orm.jpa.persistenceunit.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-21 14:56:59 INFO  [restartedMain] org.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-21 14:57:00 INFO  [restartedMain] org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-21 14:57:00 INFO  [restartedMain] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 14:57:00 INFO  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-11-21 14:57:00 WARN  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-11-21 14:57:01 WARN  [restartedMain] org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-21 14:57:02 INFO  [restartedMain] org.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:fiadopay'
2025-11-21 14:57:02 INFO  [restartedMain] org.springframework.boot.devtools.autoconfigure.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-21 14:57:02 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-11-21 14:57:02 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-11-21 14:57:02 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Started FiadoPayApplication in 6.784 seconds (process running for 7.201)
2025-11-21 14:57:03 INFO  [http-nio-8080-exec-1] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-21 14:57:03 INFO  [http-nio-8080-exec-1] org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-21 14:57:03 INFO  [http-nio-8080-exec-1] org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-11-21 14:57:07 INFO  [http-nio-8080-exec-7] edu.ucsal.fiadopay.annotations.idempontent.IdempotencyAspect - Hiiiiiiiiiiiiiiiiiiiiiiiiiii
2025-11-21 14:57:07 INFO  [http-nio-8080-exec-7] edu.ucsal.fiadopay.annotations.logged.LogAspect - TESTE ASPECT FUNCIONANDO
2025-11-21 14:57:07 INFO  [http-nio-8080-exec-7] edu.ucsal.fiadopay.annotations.validTransactionWindow.ValidTransactionWindowAspect - Olaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
2025-11-21 14:57:07 INFO  [http-nio-8080-exec-7] edu.ucsal.fiadopay.service.payment.PaymentService - Iniciando criação de pagamento merchantId=1 idemKey=123e4567-e89b-12d3-a456-426614174000 method=CARD amount=19990.50
2025-11-21 14:57:07 INFO  [http-nio-8080-exec-7] edu.ucsal.fiadopay.service.payment.PaymentService - Pagamento criado com sucesso paymentId=pay_f7046166-5e3a-4ae4-8fb9-1be40f4637f8 status=PENDING
2025-11-21 14:57:07 INFO  [pool-2-thread-1] edu.ucsal.fiadopay.service.payment.PaymentService - Processando webhook para paymentId=pay_f7046166-5e3a-4ae4-8fb9-1be40f4637f8
2025-11-21 14:57:07 INFO  [http-nio-8080-exec-7] edu.ucsal.fiadopay.annotations.logged.LogAspect - [] Executado em 20ms | args=[edu.ucsal.fiadopay.domain.merchant.Merchant@56ac7303, 123e4567-e89b-12d3-a456-426614174000, PaymentRequest[method=CARD, currency=BRL, amount=19990.50, metadataOrderId=order-123, details={installments=3}]]
2025-11-21 14:57:09 INFO  [pool-2-thread-1] edu.ucsal.fiadopay.service.payment.PaymentService - Agendando entrega de webhook eventId=evt_2ec58c6a paymentId=pay_f7046166-5e3a-4ae4-8fb9-1be40f4637f8 url=http://localhost:8081/webhooks/payments
2025-11-21 15:02:59 INFO  [SpringApplicationShutdownHook] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-21 15:02:59 INFO  [tomcat-shutdown] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-21 15:02:59 INFO  [SpringApplicationShutdownHook] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 15:02:59 WARN  [SpringApplicationShutdownHook] org.springframework.beans.factory.support.DisposableBeanAdapter - Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2025-11-21 15:02:59 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-11-21 15:03:00 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-11-21 15:03:02 INFO  [background-preinit] org.hibernate.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.3.Final
2025-11-21 15:03:02 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Starting FiadoPayApplication using Java 21.0.8 with PID 14684 (/home/andre/Documents/fiadopay-main/target/classes started by andre in /home/andre/Documents/fiadopay-main)
2025-11-21 15:03:02 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-21 15:03:02 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-11-21 15:03:02 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-11-21 15:03:03 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-21 15:03:03 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 68 ms. Found 4 JPA repository interfaces.
2025-11-21 15:03:04 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-21 15:03:04 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-11-21 15:03:04 INFO  [restartedMain] org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-11-21 15:03:04 INFO  [restartedMain] org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-21 15:03:04 INFO  [restartedMain] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-11-21 15:03:04 INFO  [restartedMain] org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1967 ms
2025-11-21 15:03:04 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-21 15:03:05 INFO  [restartedMain] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:fiadopay user=SA
2025-11-21 15:03:05 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-11-21 15:03:05 INFO  [restartedMain] org.hibernate.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-21 15:03:05 INFO  [restartedMain] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.33.Final
2025-11-21 15:03:05 INFO  [restartedMain] org.hibernate.cache.internal.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-21 15:03:05 INFO  [restartedMain] org.springframework.orm.jpa.persistenceunit.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-21 15:03:05 INFO  [restartedMain] org.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-21 15:03:06 INFO  [restartedMain] org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-21 15:03:06 INFO  [restartedMain] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 15:03:06 INFO  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-11-21 15:03:06 WARN  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-11-21 15:03:06 WARN  [restartedMain] org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-21 15:03:07 INFO  [restartedMain] org.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:fiadopay'
2025-11-21 15:03:07 INFO  [restartedMain] org.springframework.boot.devtools.autoconfigure.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-21 15:03:07 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-11-21 15:03:07 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-11-21 15:03:07 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Started FiadoPayApplication in 5.179 seconds (process running for 5.559)
2025-11-21 15:03:53 INFO  [SpringApplicationShutdownHook] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-21 15:03:53 INFO  [tomcat-shutdown] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-21 15:03:53 INFO  [SpringApplicationShutdownHook] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 15:03:53 WARN  [SpringApplicationShutdownHook] org.springframework.beans.factory.support.DisposableBeanAdapter - Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2025-11-21 15:03:53 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-11-21 15:03:53 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-11-21 15:03:57 INFO  [background-preinit] org.hibernate.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.3.Final
2025-11-21 15:03:57 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Starting FiadoPayApplication using Java 21.0.8 with PID 14804 (/home/andre/Documents/fiadopay-main/target/classes started by andre in /home/andre/Documents/fiadopay-main)
2025-11-21 15:03:57 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-21 15:03:57 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-11-21 15:03:57 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-11-21 15:03:58 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-21 15:03:58 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 48 ms. Found 4 JPA repository interfaces.
2025-11-21 15:03:58 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-21 15:03:58 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-11-21 15:03:58 INFO  [restartedMain] org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-11-21 15:03:58 INFO  [restartedMain] org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-21 15:03:58 INFO  [restartedMain] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-11-21 15:03:58 INFO  [restartedMain] org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1608 ms
2025-11-21 15:03:59 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-21 15:03:59 INFO  [restartedMain] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:fiadopay user=SA
2025-11-21 15:03:59 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-11-21 15:03:59 INFO  [restartedMain] org.hibernate.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-21 15:03:59 INFO  [restartedMain] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.33.Final
2025-11-21 15:03:59 INFO  [restartedMain] org.hibernate.cache.internal.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-21 15:03:59 INFO  [restartedMain] org.springframework.orm.jpa.persistenceunit.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-21 15:03:59 INFO  [restartedMain] org.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-21 15:04:00 INFO  [restartedMain] org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-21 15:04:00 INFO  [restartedMain] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 15:04:00 INFO  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-11-21 15:04:00 WARN  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-11-21 15:04:00 WARN  [restartedMain] org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-21 15:04:01 INFO  [restartedMain] org.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:fiadopay'
2025-11-21 15:04:01 INFO  [restartedMain] org.springframework.boot.devtools.autoconfigure.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-21 15:04:01 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-11-21 15:04:01 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-11-21 15:04:01 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Started FiadoPayApplication in 4.857 seconds (process running for 5.269)
2025-11-21 15:04:06 INFO  [http-nio-8080-exec-2] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-21 15:04:06 INFO  [http-nio-8080-exec-2] org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-21 15:04:06 INFO  [http-nio-8080-exec-2] org.springframework.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-11-21 15:04:12 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.annotations.idempontent.IdempotencyAspect - 🔁 Verificando idempotência merchantId=1 idemKey=123e4567-e89b-12d3-a456-426614174000
2025-11-21 15:04:12 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.annotations.idempontent.IdempotencyAspect - 🔁 Nenhuma operação anterior encontrada — prosseguindo execução.
2025-11-21 15:04:12 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.annotations.validTransactionWindow.ValidTransactionWindowAspect - ⏱️ Validando janela de transação amount=19990.50 now=15:04:12.595252598 greaterThan10k=true after22h=false
2025-11-21 15:04:12 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.service.payment.PaymentService - Iniciando criação de pagamento merchantId=1 idemKey=123e4567-e89b-12d3-a456-426614174000 method=CARD amount=19990.50
2025-11-21 15:04:12 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.service.payment.PaymentService - Pagamento criado com sucesso paymentId=pay_66a17a2a-9cd3-4dcf-9e88-031e5b225ed0 status=PENDING
2025-11-21 15:04:12 INFO  [pool-2-thread-1] edu.ucsal.fiadopay.service.payment.PaymentService - Processando webhook para paymentId=pay_66a17a2a-9cd3-4dcf-9e88-031e5b225ed0
2025-11-21 15:04:14 INFO  [pool-2-thread-1] edu.ucsal.fiadopay.service.payment.PaymentService - Agendando entrega de webhook eventId=evt_7af3a867 paymentId=pay_66a17a2a-9cd3-4dcf-9e88-031e5b225ed0 url=http://localhost:8081/webhooks/payments
2025-11-21 15:07:49 INFO  [SpringApplicationShutdownHook] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-21 15:07:49 INFO  [tomcat-shutdown] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-21 15:07:49 INFO  [SpringApplicationShutdownHook] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 15:07:49 WARN  [SpringApplicationShutdownHook] org.springframework.beans.factory.support.DisposableBeanAdapter - Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2025-11-21 15:07:49 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-11-21 15:07:49 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-11-21 15:07:52 INFO  [background-preinit] org.hibernate.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.3.Final
2025-11-21 15:07:52 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Starting FiadoPayApplication using Java 21.0.8 with PID 15065 (/home/andre/Documents/fiadopay-main/target/classes started by andre in /home/andre/Documents/fiadopay-main)
2025-11-21 15:07:52 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-21 15:07:52 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-11-21 15:07:52 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-11-21 15:07:53 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-21 15:07:53 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 46 ms. Found 4 JPA repository interfaces.
2025-11-21 15:07:54 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-21 15:07:54 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-11-21 15:07:54 INFO  [restartedMain] org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-11-21 15:07:54 INFO  [restartedMain] org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-21 15:07:54 INFO  [restartedMain] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-11-21 15:07:54 INFO  [restartedMain] org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1807 ms
2025-11-21 15:07:54 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-21 15:07:54 INFO  [restartedMain] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:fiadopay user=SA
2025-11-21 15:07:54 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-11-21 15:07:54 INFO  [restartedMain] org.hibernate.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-21 15:07:54 INFO  [restartedMain] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.33.Final
2025-11-21 15:07:54 INFO  [restartedMain] org.hibernate.cache.internal.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-21 15:07:55 INFO  [restartedMain] org.springframework.orm.jpa.persistenceunit.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-21 15:07:55 INFO  [restartedMain] org.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-21 15:07:55 INFO  [restartedMain] org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-21 15:07:55 INFO  [restartedMain] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 15:07:56 INFO  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-11-21 15:07:56 WARN  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-11-21 15:07:56 WARN  [restartedMain] org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-21 15:07:57 INFO  [restartedMain] org.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:fiadopay'
2025-11-21 15:07:57 INFO  [restartedMain] org.springframework.boot.devtools.autoconfigure.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-21 15:07:57 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-11-21 15:07:57 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-11-21 15:07:57 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Started FiadoPayApplication in 5.058 seconds (process running for 5.504)
2025-11-21 15:08:47 INFO  [http-nio-8080-exec-2] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-21 15:08:47 INFO  [http-nio-8080-exec-2] org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-21 15:08:47 INFO  [http-nio-8080-exec-2] org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-11-21 15:08:54 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.annotations.idempontent.IdempotencyAspect - 🔁 Verificando idempotência merchantId=1 idemKey=123e4567-e89b-12d3-a456-426614174000
2025-11-21 15:08:54 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.annotations.idempontent.IdempotencyAspect - 🔁 Nenhuma operação anterior encontrada — prosseguindo execução.
2025-11-21 15:08:54 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.annotations.validTransactionWindow.ValidTransactionWindowAspect - ⏱️ Validando janela de transação amount=19990.50 now=15:08:54.390715619 greaterThan10k=true after22h=false
2025-11-21 15:08:54 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.service.payment.PaymentService - Iniciando criação de pagamento merchantId=1 idemKey=123e4567-e89b-12d3-a456-426614174000 method=CARD amount=19990.50
2025-11-21 15:08:54 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.service.payment.PaymentService - Pagamento criado com sucesso paymentId=pay_3df40bc4-8c76-4ed4-8ecf-5ec0043bcc80 status=PENDING
2025-11-21 15:08:54 INFO  [pool-2-thread-1] edu.ucsal.fiadopay.service.payment.PaymentService - Processando webhook para paymentId=pay_3df40bc4-8c76-4ed4-8ecf-5ec0043bcc80
2025-11-21 15:08:55 INFO  [pool-2-thread-1] edu.ucsal.fiadopay.service.payment.PaymentService - Agendando entrega de webhook eventId=evt_e38301e2 paymentId=pay_3df40bc4-8c76-4ed4-8ecf-5ec0043bcc80 url=http://localhost:8081/webhooks/payments
2025-11-21 15:11:26 INFO  [SpringApplicationShutdownHook] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-21 15:11:26 INFO  [tomcat-shutdown] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-21 15:11:26 INFO  [SpringApplicationShutdownHook] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 15:11:26 WARN  [SpringApplicationShutdownHook] org.springframework.beans.factory.support.DisposableBeanAdapter - Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2025-11-21 15:11:26 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-11-21 15:11:26 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-11-21 15:11:30 INFO  [background-preinit] org.hibernate.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.3.Final
2025-11-21 15:11:30 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Starting FiadoPayApplication using Java 21.0.8 with PID 15380 (/home/andre/Documents/fiadopay-main/target/classes started by andre in /home/andre/Documents/fiadopay-main)
2025-11-21 15:11:30 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-21 15:11:30 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-11-21 15:11:30 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-11-21 15:11:31 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-21 15:11:32 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 45 ms. Found 4 JPA repository interfaces.
2025-11-21 15:11:32 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-21 15:11:32 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-11-21 15:11:32 INFO  [restartedMain] org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-11-21 15:11:32 INFO  [restartedMain] org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-21 15:11:32 INFO  [restartedMain] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-11-21 15:11:32 INFO  [restartedMain] org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2216 ms
2025-11-21 15:11:32 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-21 15:11:33 INFO  [restartedMain] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:fiadopay user=SA
2025-11-21 15:11:33 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-11-21 15:11:33 INFO  [restartedMain] org.hibernate.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-21 15:11:33 INFO  [restartedMain] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.33.Final
2025-11-21 15:11:33 INFO  [restartedMain] org.hibernate.cache.internal.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-21 15:11:33 INFO  [restartedMain] org.springframework.orm.jpa.persistenceunit.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-21 15:11:33 INFO  [restartedMain] org.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-21 15:11:34 INFO  [restartedMain] org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-21 15:11:34 INFO  [restartedMain] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 15:11:35 INFO  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-11-21 15:11:35 WARN  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-11-21 15:11:35 WARN  [restartedMain] org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-21 15:11:36 INFO  [restartedMain] org.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:fiadopay'
2025-11-21 15:11:36 INFO  [restartedMain] org.springframework.boot.devtools.autoconfigure.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-21 15:11:36 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-11-21 15:11:36 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-11-21 15:11:36 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Started FiadoPayApplication in 6.623 seconds (process running for 7.455)
2025-11-21 15:11:37 INFO  [http-nio-8080-exec-1] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-21 15:11:37 INFO  [http-nio-8080-exec-1] org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-21 15:11:37 INFO  [http-nio-8080-exec-1] org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-11-21 15:11:43 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.annotations.idempontent.IdempotencyAspect - 🔁 Verificando idempotência merchantId=1 idemKey=123e4567-e89b-12d3-a456-426614174000
2025-11-21 15:11:43 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.annotations.idempontent.IdempotencyAspect - 🔁 Nenhuma operação anterior encontrada — prosseguindo execução.
2025-11-21 15:11:43 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.annotations.validTransactionWindow.ValidTransactionWindowAspect - ⏱️ Validando janela de transação amount=19990.50 now=15:11:43.402104130 greaterThan10k=true after22h=false
2025-11-21 15:11:43 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.service.payment.PaymentService - Iniciando criação de pagamento merchantId=1 idemKey=123e4567-e89b-12d3-a456-426614174000 method=CARD amount=19990.50
2025-11-21 15:11:43 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.service.payment.PaymentService - Pagamento criado com sucesso paymentId=pay_6a678da3-4c70-4f54-96d6-f1bfe3ba5853 status=PENDING
2025-11-21 15:11:43 INFO  [pool-2-thread-1] edu.ucsal.fiadopay.service.payment.PaymentService - Processando webhook para paymentId=pay_6a678da3-4c70-4f54-96d6-f1bfe3ba5853
2025-11-21 15:11:44 WARN  [http-nio-8080-exec-7] edu.ucsal.fiadopay.service.payment.PaymentService - Tentativa de acesso não autorizado paymentId=pay_efd77589-e0d8-4055-84fa-c518558d3fa0 merchantId=1
2025-11-21 15:11:44 WARN  [http-nio-8080-exec-7] org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.server.ResponseStatusException: 403 FORBIDDEN "Payment does not exist or does not belong to this merchant."]
2025-11-21 15:11:44 INFO  [pool-2-thread-1] edu.ucsal.fiadopay.service.payment.PaymentService - Agendando entrega de webhook eventId=evt_7e59f150 paymentId=pay_6a678da3-4c70-4f54-96d6-f1bfe3ba5853 url=http://localhost:8081/webhooks/payments
2025-11-21 15:13:17 INFO  [SpringApplicationShutdownHook] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-21 15:13:17 INFO  [tomcat-shutdown] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-21 15:13:17 INFO  [SpringApplicationShutdownHook] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 15:13:17 WARN  [SpringApplicationShutdownHook] org.springframework.beans.factory.support.DisposableBeanAdapter - Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2025-11-21 15:13:17 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-11-21 15:13:17 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-11-21 15:13:45 INFO  [background-preinit] org.hibernate.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.3.Final
2025-11-21 15:13:45 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Starting FiadoPayApplication using Java 21.0.8 with PID 15621 (/home/andre/Documents/fiadopay-main/target/classes started by andre in /home/andre/Documents/fiadopay-main)
2025-11-21 15:13:45 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-21 15:13:45 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-11-21 15:13:45 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-11-21 15:13:46 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-21 15:13:46 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 75 ms. Found 4 JPA repository interfaces.
2025-11-21 15:13:47 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-21 15:13:47 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-11-21 15:13:47 INFO  [restartedMain] org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-11-21 15:13:47 INFO  [restartedMain] org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-21 15:13:47 INFO  [restartedMain] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-11-21 15:13:47 INFO  [restartedMain] org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2336 ms
2025-11-21 15:13:48 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-21 15:13:48 INFO  [restartedMain] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:fiadopay user=SA
2025-11-21 15:13:48 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-11-21 15:13:48 INFO  [restartedMain] org.hibernate.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-21 15:13:48 INFO  [restartedMain] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.33.Final
2025-11-21 15:13:48 INFO  [restartedMain] org.hibernate.cache.internal.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-21 15:13:48 INFO  [restartedMain] org.springframework.orm.jpa.persistenceunit.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-21 15:13:48 INFO  [restartedMain] org.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-21 15:13:49 INFO  [restartedMain] org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-21 15:13:49 INFO  [restartedMain] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 15:13:50 INFO  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-11-21 15:13:50 WARN  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-11-21 15:13:50 WARN  [restartedMain] org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-21 15:13:51 INFO  [restartedMain] org.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:fiadopay'
2025-11-21 15:13:51 INFO  [restartedMain] org.springframework.boot.devtools.autoconfigure.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-21 15:13:51 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-11-21 15:13:51 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-11-21 15:13:51 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Started FiadoPayApplication in 7.149 seconds (process running for 7.544)
2025-11-21 15:13:55 INFO  [http-nio-8080-exec-1] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-21 15:13:55 INFO  [http-nio-8080-exec-1] org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-21 15:13:55 INFO  [http-nio-8080-exec-1] org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-11-21 15:14:02 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.annotations.idempontent.IdempotencyAspect - 🔁 Verificando idempotência merchantId=1 idemKey=123e4567-e89b-12d3-a456-426614174000
2025-11-21 15:14:02 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.annotations.idempontent.IdempotencyAspect - 🔁 Nenhuma operação anterior encontrada — prosseguindo execução.
2025-11-21 15:14:02 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.annotations.logged.LogAspect - TESTE ASPECT FUNCIONANDO
2025-11-21 15:14:02 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.annotations.validTransactionWindow.ValidTransactionWindowAspect - ⏱️ Validando janela de transação amount=19990.50 now=15:14:02.255189326 greaterThan10k=true after22h=false
2025-11-21 15:14:02 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.service.payment.PaymentService - Iniciando criação de pagamento merchantId=1 idemKey=123e4567-e89b-12d3-a456-426614174000 method=CARD amount=19990.50
2025-11-21 15:14:02 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.service.payment.PaymentService - Pagamento criado com sucesso paymentId=pay_78da7b72-38a9-45af-8883-6b5477053de0 status=PENDING
2025-11-21 15:14:02 INFO  [pool-2-thread-1] edu.ucsal.fiadopay.service.payment.PaymentService - Processando webhook para paymentId=pay_78da7b72-38a9-45af-8883-6b5477053de0
2025-11-21 15:14:02 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.annotations.logged.LogAspect - [metricas] Executado em 19ms | args=[edu.ucsal.fiadopay.domain.merchant.Merchant@637e5e6e, 123e4567-e89b-12d3-a456-426614174000, PaymentRequest[method=CARD, currency=BRL, amount=19990.50, metadataOrderId=order-123, details={installments=3}]]
2025-11-21 15:14:03 INFO  [pool-2-thread-1] edu.ucsal.fiadopay.service.payment.PaymentService - Agendando entrega de webhook eventId=evt_0993fa76 paymentId=pay_78da7b72-38a9-45af-8883-6b5477053de0 url=http://localhost:8081/webhooks/payments
2025-11-21 15:14:03 WARN  [http-nio-8080-exec-7] edu.ucsal.fiadopay.service.payment.PaymentService - Tentativa de acesso não autorizado paymentId=pay_efd77589-e0d8-4055-84fa-c518558d3fa0 merchantId=1
2025-11-21 15:14:03 WARN  [http-nio-8080-exec-7] org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.server.ResponseStatusException: 403 FORBIDDEN "Payment does not exist or does not belong to this merchant."]
2025-11-21 15:17:09 INFO  [SpringApplicationShutdownHook] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-21 15:17:09 INFO  [tomcat-shutdown] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-21 15:17:09 INFO  [SpringApplicationShutdownHook] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 15:17:09 WARN  [SpringApplicationShutdownHook] org.springframework.beans.factory.support.DisposableBeanAdapter - Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2025-11-21 15:17:09 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-11-21 15:17:09 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-11-21 15:17:13 INFO  [background-preinit] org.hibernate.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.3.Final
2025-11-21 15:17:13 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Starting FiadoPayApplication using Java 21.0.8 with PID 15906 (/home/andre/Documents/fiadopay-main/target/classes started by andre in /home/andre/Documents/fiadopay-main)
2025-11-21 15:17:13 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-21 15:17:13 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-11-21 15:17:13 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-11-21 15:17:14 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-21 15:17:14 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 56 ms. Found 4 JPA repository interfaces.
2025-11-21 15:17:15 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-21 15:17:15 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-11-21 15:17:15 INFO  [restartedMain] org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-11-21 15:17:15 INFO  [restartedMain] org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-21 15:17:15 INFO  [restartedMain] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-11-21 15:17:15 INFO  [restartedMain] org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2120 ms
2025-11-21 15:17:16 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-21 15:17:16 INFO  [restartedMain] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:fiadopay user=SA
2025-11-21 15:17:16 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-11-21 15:17:16 INFO  [restartedMain] org.hibernate.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-21 15:17:16 INFO  [restartedMain] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.33.Final
2025-11-21 15:17:16 INFO  [restartedMain] org.hibernate.cache.internal.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-21 15:17:16 INFO  [restartedMain] org.springframework.orm.jpa.persistenceunit.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-21 15:17:16 INFO  [restartedMain] org.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-21 15:17:17 INFO  [restartedMain] org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-21 15:17:17 INFO  [restartedMain] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 15:17:17 INFO  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-11-21 15:17:17 WARN  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-11-21 15:17:18 WARN  [restartedMain] org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-21 15:17:18 INFO  [restartedMain] org.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:fiadopay'
2025-11-21 15:17:18 INFO  [restartedMain] org.springframework.boot.devtools.autoconfigure.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-21 15:17:18 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-11-21 15:17:18 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-11-21 15:17:18 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Started FiadoPayApplication in 5.822 seconds (process running for 6.286)
2025-11-21 15:18:35 INFO  [http-nio-8080-exec-1] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-21 15:18:35 INFO  [http-nio-8080-exec-1] org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-21 15:18:35 INFO  [http-nio-8080-exec-1] org.springframework.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-11-21 15:18:40 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.annotations.idempontent.IdempotencyAspect - 🔁 Verificando idempotência merchantId=1 idemKey=123e4567-e89b-12d3-a456-426614174000
2025-11-21 15:18:40 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.annotations.idempontent.IdempotencyAspect - 🔁 Nenhuma operação anterior encontrada — prosseguindo execução.
2025-11-21 15:18:40 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.annotations.validTransactionWindow.ValidTransactionWindowAspect - ⏱️ Validando janela de transação amount=19990.50 now=15:18:40.379955712 greaterThan10k=true after22h=false
2025-11-21 15:18:40 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.service.payment.PaymentService - Iniciando criação de pagamento merchantId=1 idemKey=123e4567-e89b-12d3-a456-426614174000 method=CARD amount=19990.50
2025-11-21 15:18:40 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.service.payment.PaymentService - Pagamento criado com sucesso paymentId=pay_52dd5268-6c60-4c84-8043-1de38abf0440 status=PENDING
2025-11-21 15:18:40 INFO  [pool-2-thread-1] edu.ucsal.fiadopay.service.payment.PaymentService - Processando webhook para paymentId=pay_52dd5268-6c60-4c84-8043-1de38abf0440
2025-11-21 15:18:40 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.annotations.logged.LogAspect - [metricas] Executado em 40ms | args=[edu.ucsal.fiadopay.domain.merchant.Merchant@615ade8e, 123e4567-e89b-12d3-a456-426614174000, PaymentRequest[method=CARD, currency=BRL, amount=19990.50, metadataOrderId=order-123, details={installments=3}]]
2025-11-21 15:18:41 WARN  [http-nio-8080-exec-7] edu.ucsal.fiadopay.service.payment.PaymentService - Tentativa de acesso não autorizado paymentId=pay_efd77589-e0d8-4055-84fa-c518558d3fa0 merchantId=1
2025-11-21 15:18:41 WARN  [http-nio-8080-exec-7] org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.server.ResponseStatusException: 403 FORBIDDEN "Payment does not exist or does not belong to this merchant."]
2025-11-21 15:18:41 INFO  [pool-2-thread-1] edu.ucsal.fiadopay.service.payment.PaymentService - Agendando entrega de webhook eventId=evt_300ddec1 paymentId=pay_52dd5268-6c60-4c84-8043-1de38abf0440 url=http://localhost:8081/webhooks/payments
2025-11-21 15:26:19 INFO  [SpringApplicationShutdownHook] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-21 15:26:19 INFO  [tomcat-shutdown] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-21 15:26:19 INFO  [SpringApplicationShutdownHook] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 15:26:19 WARN  [SpringApplicationShutdownHook] org.springframework.beans.factory.support.DisposableBeanAdapter - Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2025-11-21 15:26:19 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-11-21 15:26:19 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-11-21 15:26:22 INFO  [background-preinit] org.hibernate.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.3.Final
2025-11-21 15:26:23 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Starting FiadoPayApplication using Java 21.0.8 with PID 16827 (/home/andre/Documents/fiadopay-main/target/classes started by andre in /home/andre/Documents/fiadopay-main)
2025-11-21 15:26:23 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-21 15:26:23 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-11-21 15:26:23 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-11-21 15:26:24 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-21 15:26:24 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 71 ms. Found 4 JPA repository interfaces.
2025-11-21 15:26:25 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-21 15:26:25 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-11-21 15:26:25 INFO  [restartedMain] org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-11-21 15:26:25 INFO  [restartedMain] org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-21 15:26:25 INFO  [restartedMain] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-11-21 15:26:25 INFO  [restartedMain] org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2499 ms
2025-11-21 15:26:25 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-21 15:26:26 INFO  [restartedMain] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:fiadopay user=SA
2025-11-21 15:26:26 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-11-21 15:26:26 INFO  [restartedMain] org.hibernate.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-21 15:26:26 INFO  [restartedMain] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.33.Final
2025-11-21 15:26:26 INFO  [restartedMain] org.hibernate.cache.internal.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-21 15:26:26 INFO  [restartedMain] org.springframework.orm.jpa.persistenceunit.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-21 15:26:26 INFO  [restartedMain] org.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-21 15:26:27 INFO  [restartedMain] org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-21 15:26:27 INFO  [restartedMain] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 15:26:28 INFO  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-11-21 15:26:28 WARN  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-11-21 15:26:28 WARN  [restartedMain] org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-21 15:26:29 INFO  [restartedMain] org.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:fiadopay'
2025-11-21 15:26:29 INFO  [restartedMain] org.springframework.boot.devtools.autoconfigure.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-21 15:26:29 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-11-21 15:26:29 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-11-21 15:26:29 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Started FiadoPayApplication in 6.955 seconds (process running for 7.393)
2025-11-21 15:26:41 INFO  [http-nio-8080-exec-2] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-21 15:26:41 INFO  [http-nio-8080-exec-2] org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-21 15:26:41 INFO  [http-nio-8080-exec-2] org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-11-21 15:26:47 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.annotations.idempontent.IdempotencyAspect - 🔁 Verificando idempotência merchantId=1 idemKey=123e4567-e89b-12d3-a456-426614174000
2025-11-21 15:26:47 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.annotations.idempontent.IdempotencyAspect - 🔁 Nenhuma operação anterior encontrada — prosseguindo execução.
2025-11-21 15:26:47 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.annotations.validTransactionWindow.ValidTransactionWindowAspect - ⏱️ Validando janela de transação amount=19990.50 now=15:26:47.194847229 greaterThan10k=true after22h=false
2025-11-21 15:26:47 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.service.payment.PaymentService - Iniciando criação de pagamento merchantId=1 idemKey=123e4567-e89b-12d3-a456-426614174000 method=CARD amount=19990.50
2025-11-21 15:26:47 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.service.payment.PaymentService - Pagamento criado com sucesso paymentId=pay_ab8b16f1-b304-45ae-b099-bcfcad958206 status=PENDING
2025-11-21 15:26:47 INFO  [pool-2-thread-1] edu.ucsal.fiadopay.service.payment.PaymentService - Processando webhook para paymentId=pay_ab8b16f1-b304-45ae-b099-bcfcad958206
2025-11-21 15:26:47 INFO  [http-nio-8080-exec-6] edu.ucsal.fiadopay.annotations.logged.LogAspect - [metricas] Executado em 34ms | args=[edu.ucsal.fiadopay.domain.merchant.Merchant@644e4bae, 123e4567-e89b-12d3-a456-426614174000, PaymentRequest[method=CARD, currency=BRL, amount=19990.50, metadataOrderId=order-123, details={installments=3}]]
2025-11-21 15:26:48 INFO  [pool-2-thread-1] edu.ucsal.fiadopay.service.payment.PaymentService - Agendando entrega de webhook eventId=evt_0d26d2f6 paymentId=pay_ab8b16f1-b304-45ae-b099-bcfcad958206 url=http://localhost:8081/webhooks/payments
2025-11-21 15:26:48 INFO  [pool-2-thread-1] edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService - Webhook agendado: id=1, url=http://localhost:8081/webhooks/payments, payloadSize=176
2025-11-21 15:26:48 INFO  [pool-3-thread-1] edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService - Iniciando tentativa 1 para webhook id=1 (url=http://localhost:8081/webhooks/payments)
2025-11-21 15:26:48 ERROR [pool-3-thread-1] edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService - Erro inesperado no webhook id=1: null
java.net.ConnectException: null
	at java.net.http/jdk.internal.net.http.HttpClientImpl.send(HttpClientImpl.java:955)
	at java.net.http/jdk.internal.net.http.HttpClientFacade.send(HttpClientFacade.java:133)
	at edu.ucsal.fiadopay.service.webhook.WebhookSender.send(WebhookSender.java:23)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.attempt(WebhookDeliveryService.java:56)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.lambda$scheduleDelivery$0(WebhookDeliveryService.java:39)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.net.ConnectException: null
	at java.net.http/jdk.internal.net.http.common.Utils.toConnectException(Utils.java:1065)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.connectAsync(PlainHttpConnection.java:227)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.checkRetryConnect(PlainHttpConnection.java:280)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.lambda$connectAsync$2(PlainHttpConnection.java:238)
	at java.base/java.util.concurrent.CompletableFuture.uniHandle(CompletableFuture.java:934)
	at java.base/java.util.concurrent.CompletableFuture$UniHandle.tryFire(CompletableFuture.java:911)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1773)
	... 3 common frames omitted
Caused by: java.nio.channels.ClosedChannelException: null
	at java.base/sun.nio.ch.SocketChannelImpl.ensureOpen(SocketChannelImpl.java:202)
	at java.base/sun.nio.ch.SocketChannelImpl.beginConnect(SocketChannelImpl.java:786)
	at java.base/sun.nio.ch.SocketChannelImpl.connect(SocketChannelImpl.java:874)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.lambda$connectAsync$1(PlainHttpConnection.java:210)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:571)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.connectAsync(PlainHttpConnection.java:212)
	... 9 common frames omitted
2025-11-21 15:26:48 WARN  [pool-3-thread-1] edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService - Erro – reagendando id=1 para daqui 1000ms
2025-11-21 15:26:49 INFO  [pool-3-thread-1] edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService - Iniciando tentativa 2 para webhook id=1 (url=http://localhost:8081/webhooks/payments)
2025-11-21 15:26:49 ERROR [pool-3-thread-1] edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService - Erro inesperado no webhook id=1: null
java.net.ConnectException: null
	at java.net.http/jdk.internal.net.http.HttpClientImpl.send(HttpClientImpl.java:955)
	at java.net.http/jdk.internal.net.http.HttpClientFacade.send(HttpClientFacade.java:133)
	at edu.ucsal.fiadopay.service.webhook.WebhookSender.send(WebhookSender.java:23)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.attempt(WebhookDeliveryService.java:56)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.attempt(WebhookDeliveryService.java:90)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.lambda$scheduleDelivery$0(WebhookDeliveryService.java:39)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.net.ConnectException: null
	at java.net.http/jdk.internal.net.http.common.Utils.toConnectException(Utils.java:1065)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.connectAsync(PlainHttpConnection.java:227)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.checkRetryConnect(PlainHttpConnection.java:280)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.lambda$connectAsync$2(PlainHttpConnection.java:238)
	at java.base/java.util.concurrent.CompletableFuture.uniHandle(CompletableFuture.java:934)
	at java.base/java.util.concurrent.CompletableFuture$UniHandle.tryFire(CompletableFuture.java:911)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1773)
	... 3 common frames omitted
Caused by: java.nio.channels.ClosedChannelException: null
	at java.base/sun.nio.ch.SocketChannelImpl.ensureOpen(SocketChannelImpl.java:202)
	at java.base/sun.nio.ch.SocketChannelImpl.beginConnect(SocketChannelImpl.java:786)
	at java.base/sun.nio.ch.SocketChannelImpl.connect(SocketChannelImpl.java:874)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.lambda$connectAsync$1(PlainHttpConnection.java:210)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:571)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.connectAsync(PlainHttpConnection.java:212)
	... 9 common frames omitted
2025-11-21 15:26:49 WARN  [pool-3-thread-1] edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService - Erro – reagendando id=1 para daqui 2000ms
2025-11-21 15:26:51 INFO  [pool-3-thread-1] edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService - Iniciando tentativa 3 para webhook id=1 (url=http://localhost:8081/webhooks/payments)
2025-11-21 15:26:51 ERROR [pool-3-thread-1] edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService - Erro inesperado no webhook id=1: null
java.net.ConnectException: null
	at java.net.http/jdk.internal.net.http.HttpClientImpl.send(HttpClientImpl.java:955)
	at java.net.http/jdk.internal.net.http.HttpClientFacade.send(HttpClientFacade.java:133)
	at edu.ucsal.fiadopay.service.webhook.WebhookSender.send(WebhookSender.java:23)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.attempt(WebhookDeliveryService.java:56)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.attempt(WebhookDeliveryService.java:90)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.attempt(WebhookDeliveryService.java:90)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.lambda$scheduleDelivery$0(WebhookDeliveryService.java:39)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.net.ConnectException: null
	at java.net.http/jdk.internal.net.http.common.Utils.toConnectException(Utils.java:1065)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.connectAsync(PlainHttpConnection.java:227)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.checkRetryConnect(PlainHttpConnection.java:280)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.lambda$connectAsync$2(PlainHttpConnection.java:238)
	at java.base/java.util.concurrent.CompletableFuture.uniHandle(CompletableFuture.java:934)
	at java.base/java.util.concurrent.CompletableFuture$UniHandle.tryFire(CompletableFuture.java:911)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1773)
	... 3 common frames omitted
Caused by: java.nio.channels.ClosedChannelException: null
	at java.base/sun.nio.ch.SocketChannelImpl.ensureOpen(SocketChannelImpl.java:202)
	at java.base/sun.nio.ch.SocketChannelImpl.beginConnect(SocketChannelImpl.java:786)
	at java.base/sun.nio.ch.SocketChannelImpl.connect(SocketChannelImpl.java:874)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.lambda$connectAsync$1(PlainHttpConnection.java:210)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:571)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.connectAsync(PlainHttpConnection.java:212)
	... 9 common frames omitted
2025-11-21 15:26:51 WARN  [pool-3-thread-1] edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService - Erro – reagendando id=1 para daqui 3000ms
2025-11-21 15:26:54 INFO  [pool-3-thread-1] edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService - Iniciando tentativa 4 para webhook id=1 (url=http://localhost:8081/webhooks/payments)
2025-11-21 15:26:54 ERROR [pool-3-thread-1] edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService - Erro inesperado no webhook id=1: null
java.net.ConnectException: null
	at java.net.http/jdk.internal.net.http.HttpClientImpl.send(HttpClientImpl.java:955)
	at java.net.http/jdk.internal.net.http.HttpClientFacade.send(HttpClientFacade.java:133)
	at edu.ucsal.fiadopay.service.webhook.WebhookSender.send(WebhookSender.java:23)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.attempt(WebhookDeliveryService.java:56)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.attempt(WebhookDeliveryService.java:90)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.attempt(WebhookDeliveryService.java:90)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.attempt(WebhookDeliveryService.java:90)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.lambda$scheduleDelivery$0(WebhookDeliveryService.java:39)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.net.ConnectException: null
	at java.net.http/jdk.internal.net.http.common.Utils.toConnectException(Utils.java:1065)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.connectAsync(PlainHttpConnection.java:227)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.checkRetryConnect(PlainHttpConnection.java:280)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.lambda$connectAsync$2(PlainHttpConnection.java:238)
	at java.base/java.util.concurrent.CompletableFuture.uniHandle(CompletableFuture.java:934)
	at java.base/java.util.concurrent.CompletableFuture$UniHandle.tryFire(CompletableFuture.java:911)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1773)
	... 3 common frames omitted
Caused by: java.nio.channels.ClosedChannelException: null
	at java.base/sun.nio.ch.SocketChannelImpl.ensureOpen(SocketChannelImpl.java:202)
	at java.base/sun.nio.ch.SocketChannelImpl.beginConnect(SocketChannelImpl.java:786)
	at java.base/sun.nio.ch.SocketChannelImpl.connect(SocketChannelImpl.java:874)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.lambda$connectAsync$1(PlainHttpConnection.java:210)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:571)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.connectAsync(PlainHttpConnection.java:212)
	... 9 common frames omitted
2025-11-21 15:26:54 WARN  [pool-3-thread-1] edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService - Erro – reagendando id=1 para daqui 4000ms
2025-11-21 15:26:58 INFO  [pool-3-thread-1] edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService - Iniciando tentativa 5 para webhook id=1 (url=http://localhost:8081/webhooks/payments)
2025-11-21 15:26:58 ERROR [pool-3-thread-1] edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService - Erro inesperado no webhook id=1: null
java.net.ConnectException: null
	at java.net.http/jdk.internal.net.http.HttpClientImpl.send(HttpClientImpl.java:955)
	at java.net.http/jdk.internal.net.http.HttpClientFacade.send(HttpClientFacade.java:133)
	at edu.ucsal.fiadopay.service.webhook.WebhookSender.send(WebhookSender.java:23)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.attempt(WebhookDeliveryService.java:56)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.attempt(WebhookDeliveryService.java:90)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.attempt(WebhookDeliveryService.java:90)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.attempt(WebhookDeliveryService.java:90)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.attempt(WebhookDeliveryService.java:90)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.lambda$scheduleDelivery$0(WebhookDeliveryService.java:39)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.net.ConnectException: null
	at java.net.http/jdk.internal.net.http.common.Utils.toConnectException(Utils.java:1065)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.connectAsync(PlainHttpConnection.java:227)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.checkRetryConnect(PlainHttpConnection.java:280)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.lambda$connectAsync$2(PlainHttpConnection.java:238)
	at java.base/java.util.concurrent.CompletableFuture.uniHandle(CompletableFuture.java:934)
	at java.base/java.util.concurrent.CompletableFuture$UniHandle.tryFire(CompletableFuture.java:911)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1773)
	... 3 common frames omitted
Caused by: java.nio.channels.ClosedChannelException: null
	at java.base/sun.nio.ch.SocketChannelImpl.ensureOpen(SocketChannelImpl.java:202)
	at java.base/sun.nio.ch.SocketChannelImpl.beginConnect(SocketChannelImpl.java:786)
	at java.base/sun.nio.ch.SocketChannelImpl.connect(SocketChannelImpl.java:874)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.lambda$connectAsync$1(PlainHttpConnection.java:210)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:571)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.connectAsync(PlainHttpConnection.java:212)
	... 9 common frames omitted
2025-11-21 15:26:58 ERROR [pool-3-thread-1] edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService - Webhook id=1 falhou definitivamente após 5 tentativas.
2025-11-21 15:47:09 INFO  [SpringApplicationShutdownHook] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-21 15:47:09 INFO  [tomcat-shutdown] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-21 15:47:09 INFO  [SpringApplicationShutdownHook] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 15:47:09 WARN  [SpringApplicationShutdownHook] org.springframework.beans.factory.support.DisposableBeanAdapter - Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2025-11-21 15:47:09 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-11-21 15:47:09 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-11-21 15:47:22 INFO  [background-preinit] org.hibernate.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.3.Final
2025-11-21 15:47:22 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Starting FiadoPayApplication using Java 21.0.8 with PID 20969 (/home/andre/Documents/fiadopay-main/target/classes started by andre in /home/andre/Documents/fiadopay-main)
2025-11-21 15:47:22 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-21 15:47:22 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-11-21 15:47:22 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-11-21 15:47:23 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-21 15:47:23 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 95 ms. Found 4 JPA repository interfaces.
2025-11-21 15:47:24 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-21 15:47:24 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-11-21 15:47:24 INFO  [restartedMain] org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-11-21 15:47:24 INFO  [restartedMain] org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-21 15:47:24 INFO  [restartedMain] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-11-21 15:47:24 INFO  [restartedMain] org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2441 ms
2025-11-21 15:47:24 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-21 15:47:25 INFO  [restartedMain] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:fiadopay user=SA
2025-11-21 15:47:25 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-11-21 15:47:25 INFO  [restartedMain] org.hibernate.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-21 15:47:25 INFO  [restartedMain] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.33.Final
2025-11-21 15:47:25 INFO  [restartedMain] org.hibernate.cache.internal.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-21 15:47:25 INFO  [restartedMain] org.springframework.orm.jpa.persistenceunit.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-21 15:47:25 INFO  [restartedMain] org.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-21 15:47:26 INFO  [restartedMain] org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-21 15:47:26 INFO  [restartedMain] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 15:47:27 INFO  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-11-21 15:47:27 WARN  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-11-21 15:47:27 WARN  [restartedMain] org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-21 15:47:27 INFO  [restartedMain] org.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:fiadopay'
2025-11-21 15:47:28 INFO  [restartedMain] org.springframework.boot.devtools.autoconfigure.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-21 15:47:28 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-11-21 15:47:28 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-11-21 15:47:28 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Started FiadoPayApplication in 7.197 seconds (process running for 8.257)
2025-11-21 15:50:28 INFO  [SpringApplicationShutdownHook] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-21 15:50:28 INFO  [tomcat-shutdown] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-21 15:50:28 INFO  [SpringApplicationShutdownHook] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 15:50:28 WARN  [SpringApplicationShutdownHook] org.springframework.beans.factory.support.DisposableBeanAdapter - Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2025-11-21 15:50:28 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-11-21 15:50:28 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-11-21 15:50:31 INFO  [background-preinit] org.hibernate.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.3.Final
2025-11-21 15:50:31 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Starting FiadoPayApplication using Java 21.0.8 with PID 21270 (/home/andre/Documents/fiadopay-main/target/classes started by andre in /home/andre/Documents/fiadopay-main)
2025-11-21 15:50:31 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-21 15:50:31 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-11-21 15:50:31 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-11-21 15:50:32 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-21 15:50:32 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 79 ms. Found 4 JPA repository interfaces.
2025-11-21 15:50:33 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-21 15:50:33 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-11-21 15:50:33 INFO  [restartedMain] org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-11-21 15:50:33 INFO  [restartedMain] org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-21 15:50:33 INFO  [restartedMain] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-11-21 15:50:33 INFO  [restartedMain] org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2023 ms
2025-11-21 15:50:33 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-21 15:50:33 INFO  [restartedMain] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:fiadopay user=SA
2025-11-21 15:50:33 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-11-21 15:50:33 INFO  [restartedMain] org.hibernate.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-21 15:50:33 INFO  [restartedMain] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.33.Final
2025-11-21 15:50:34 INFO  [restartedMain] org.hibernate.cache.internal.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-21 15:50:34 INFO  [restartedMain] org.springframework.orm.jpa.persistenceunit.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-21 15:50:34 INFO  [restartedMain] org.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-21 15:50:34 INFO  [restartedMain] org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-21 15:50:35 INFO  [restartedMain] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 15:50:35 INFO  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-11-21 15:50:35 WARN  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-11-21 15:50:35 WARN  [restartedMain] org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-21 15:50:36 INFO  [restartedMain] org.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:fiadopay'
2025-11-21 15:50:36 INFO  [restartedMain] org.springframework.boot.devtools.autoconfigure.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-21 15:50:36 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-11-21 15:50:36 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-11-21 15:50:36 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Started FiadoPayApplication in 5.168 seconds (process running for 5.699)
2025-11-21 15:59:52 INFO  [File Watcher] org.springframework.boot.devtools.autoconfigure.LocalDevToolsAutoConfiguration$RestartingClassPathChangeChangedEventListener - Restarting due to 1 class path change (0 additions, 1 deletion, 0 modifications)
2025-11-21 15:59:52 INFO  [Thread-5] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-21 15:59:52 INFO  [tomcat-shutdown] org.apache.coyote.http11.Http11NioProtocol - Pausing ProtocolHandler ["http-nio-8080"]
2025-11-21 15:59:52 INFO  [tomcat-shutdown] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-21 15:59:52 INFO  [Thread-5] org.apache.coyote.http11.Http11NioProtocol - Stopping ProtocolHandler ["http-nio-8080"]
2025-11-21 15:59:52 INFO  [Thread-5] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 15:59:52 WARN  [Thread-5] org.springframework.beans.factory.support.DisposableBeanAdapter - Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2025-11-21 15:59:52 INFO  [Thread-5] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-11-21 15:59:52 INFO  [Thread-5] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-11-21 15:59:53 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Starting FiadoPayApplication using Java 21.0.8 with PID 21270 (/home/andre/Documents/fiadopay-main/target/classes started by andre in /home/andre/Documents/fiadopay-main)
2025-11-21 15:59:53 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-21 15:59:53 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-21 15:59:53 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 20 ms. Found 4 JPA repository interfaces.
2025-11-21 15:59:53 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-21 15:59:53 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-11-21 15:59:53 INFO  [restartedMain] org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-11-21 15:59:53 INFO  [restartedMain] org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-21 15:59:53 INFO  [restartedMain] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-11-21 15:59:53 INFO  [restartedMain] org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 575 ms
2025-11-21 15:59:53 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Starting...
2025-11-21 15:59:53 INFO  [restartedMain] com.zaxxer.hikari.pool.HikariPool - HikariPool-2 - Added connection conn10: url=jdbc:h2:mem:fiadopay user=SA
2025-11-21 15:59:53 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Start completed.
2025-11-21 15:59:53 INFO  [restartedMain] org.hibernate.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-21 15:59:53 INFO  [restartedMain] org.hibernate.cache.internal.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-21 15:59:53 INFO  [restartedMain] org.springframework.orm.jpa.persistenceunit.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-21 15:59:53 INFO  [restartedMain] org.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-2)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-21 15:59:53 INFO  [restartedMain] org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-21 15:59:53 INFO  [restartedMain] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 15:59:54 INFO  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-11-21 15:59:54 WARN  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-11-21 15:59:54 WARN  [restartedMain] org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-21 15:59:54 INFO  [restartedMain] org.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:fiadopay'
2025-11-21 15:59:54 INFO  [restartedMain] org.springframework.boot.devtools.autoconfigure.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-21 15:59:54 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-11-21 15:59:54 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-11-21 15:59:54 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Started FiadoPayApplication in 1.418 seconds (process running for 564.009)
2025-11-21 15:59:54 INFO  [restartedMain] org.springframework.boot.devtools.autoconfigure.ConditionEvaluationDeltaLoggingListener - Condition evaluation unchanged
2025-11-21 15:59:55 INFO  [File Watcher] org.springframework.boot.devtools.autoconfigure.LocalDevToolsAutoConfiguration$RestartingClassPathChangeChangedEventListener - Restarting due to 1 class path change (1 addition, 0 deletions, 0 modifications)
2025-11-21 15:59:55 INFO  [Thread-7] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-21 15:59:55 INFO  [tomcat-shutdown] org.apache.coyote.http11.Http11NioProtocol - Pausing ProtocolHandler ["http-nio-8080"]
2025-11-21 15:59:55 INFO  [tomcat-shutdown] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-21 15:59:55 INFO  [Thread-7] org.apache.coyote.http11.Http11NioProtocol - Stopping ProtocolHandler ["http-nio-8080"]
2025-11-21 15:59:55 INFO  [Thread-7] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 15:59:55 WARN  [Thread-7] org.springframework.beans.factory.support.DisposableBeanAdapter - Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2025-11-21 15:59:55 INFO  [Thread-7] com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Shutdown initiated...
2025-11-21 15:59:55 INFO  [Thread-7] com.zaxxer.hikari.HikariDataSource - HikariPool-2 - Shutdown completed.
2025-11-21 15:59:55 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Starting FiadoPayApplication using Java 21.0.8 with PID 21270 (/home/andre/Documents/fiadopay-main/target/classes started by andre in /home/andre/Documents/fiadopay-main)
2025-11-21 15:59:55 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-21 15:59:56 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-21 15:59:56 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 15 ms. Found 4 JPA repository interfaces.
2025-11-21 15:59:56 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-21 15:59:56 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-11-21 15:59:56 INFO  [restartedMain] org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-11-21 15:59:56 INFO  [restartedMain] org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-21 15:59:56 INFO  [restartedMain] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-11-21 15:59:56 INFO  [restartedMain] org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 404 ms
2025-11-21 15:59:56 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-3 - Starting...
2025-11-21 15:59:56 INFO  [restartedMain] com.zaxxer.hikari.pool.HikariPool - HikariPool-3 - Added connection conn20: url=jdbc:h2:mem:fiadopay user=SA
2025-11-21 15:59:56 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-3 - Start completed.
2025-11-21 15:59:56 INFO  [restartedMain] org.hibernate.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-21 15:59:56 INFO  [restartedMain] org.hibernate.cache.internal.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-21 15:59:56 INFO  [restartedMain] org.springframework.orm.jpa.persistenceunit.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-21 15:59:56 INFO  [restartedMain] org.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-3)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-21 15:59:56 INFO  [restartedMain] org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-21 15:59:56 INFO  [restartedMain] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 15:59:56 INFO  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-11-21 15:59:56 WARN  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-11-21 15:59:57 WARN  [restartedMain] org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-21 15:59:57 INFO  [restartedMain] org.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:fiadopay'
2025-11-21 15:59:57 INFO  [restartedMain] org.springframework.boot.devtools.autoconfigure.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-21 15:59:57 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-11-21 15:59:57 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-11-21 15:59:57 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Started FiadoPayApplication in 1.474 seconds (process running for 566.912)
2025-11-21 15:59:57 INFO  [restartedMain] org.springframework.boot.devtools.autoconfigure.ConditionEvaluationDeltaLoggingListener - Condition evaluation unchanged
2025-11-21 16:01:04 INFO  [http-nio-8080-exec-2] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-21 16:01:04 INFO  [http-nio-8080-exec-2] org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-21 16:01:04 INFO  [http-nio-8080-exec-2] org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-11-21 16:01:05 WARN  [http-nio-8080-exec-2] org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver - Resolved [java.lang.RuntimeException: Credenciais inválidas]
2025-11-21 16:13:36 INFO  [SpringApplicationShutdownHook] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-21 16:13:36 INFO  [tomcat-shutdown] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-21 16:13:36 INFO  [SpringApplicationShutdownHook] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 16:13:36 WARN  [SpringApplicationShutdownHook] org.springframework.beans.factory.support.DisposableBeanAdapter - Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2025-11-21 16:13:36 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-3 - Shutdown initiated...
2025-11-21 16:13:36 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-3 - Shutdown completed.
2025-11-21 16:13:39 INFO  [background-preinit] org.hibernate.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.3.Final
2025-11-21 16:13:39 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Starting FiadoPayApplication using Java 21.0.8 with PID 22690 (/home/andre/Documents/fiadopay-main/target/classes started by andre in /home/andre/Documents/fiadopay-main)
2025-11-21 16:13:39 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-21 16:13:40 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-11-21 16:13:40 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-11-21 16:13:40 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-21 16:13:41 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 49 ms. Found 4 JPA repository interfaces.
2025-11-21 16:13:41 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-21 16:13:41 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-11-21 16:13:41 INFO  [restartedMain] org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-11-21 16:13:41 INFO  [restartedMain] org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-21 16:13:41 INFO  [restartedMain] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-11-21 16:13:41 INFO  [restartedMain] org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1813 ms
2025-11-21 16:13:41 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-21 16:13:42 INFO  [restartedMain] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:fiadopay user=SA
2025-11-21 16:13:42 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-11-21 16:13:42 INFO  [restartedMain] org.hibernate.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-21 16:13:42 INFO  [restartedMain] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.33.Final
2025-11-21 16:13:42 INFO  [restartedMain] org.hibernate.cache.internal.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-21 16:13:42 INFO  [restartedMain] org.springframework.orm.jpa.persistenceunit.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-21 16:13:42 INFO  [restartedMain] org.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-21 16:13:43 INFO  [restartedMain] org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-21 16:13:43 INFO  [restartedMain] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 16:13:44 INFO  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-11-21 16:13:44 WARN  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-11-21 16:13:44 WARN  [restartedMain] org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-21 16:13:44 INFO  [restartedMain] org.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:fiadopay'
2025-11-21 16:13:44 INFO  [restartedMain] org.springframework.boot.devtools.autoconfigure.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-21 16:13:44 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-11-21 16:13:44 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-11-21 16:13:44 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Started FiadoPayApplication in 5.684 seconds (process running for 6.114)
2025-11-21 16:15:19 INFO  [http-nio-8080-exec-2] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-11-21 16:15:19 INFO  [http-nio-8080-exec-2] org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-11-21 16:15:19 INFO  [http-nio-8080-exec-2] org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-11-21 16:22:17 INFO  [http-nio-8080-exec-3] edu.ucsal.fiadopay.annotations.idempontent.IdempotencyAspect - 🔁 Verificando idempotência merchantId=1 idemKey=123e4567-e89b-12d3-a456-426614174000
2025-11-21 16:22:17 INFO  [http-nio-8080-exec-3] edu.ucsal.fiadopay.annotations.idempontent.IdempotencyAspect - 🔁 Nenhuma operação anterior encontrada — prosseguindo execução.
2025-11-21 16:22:17 INFO  [http-nio-8080-exec-3] edu.ucsal.fiadopay.annotations.validTransactionWindow.ValidTransactionWindowAspect - ⏱️ Validando janela de transação amount=19990.50 now=16:22:17.786471030 greaterThan10k=true after22h=false
2025-11-21 16:22:17 INFO  [http-nio-8080-exec-3] edu.ucsal.fiadopay.service.payment.PaymentService - Iniciando criação de pagamento merchantId=1 idemKey=123e4567-e89b-12d3-a456-426614174000 method=CARD amount=19990.50
2025-11-21 16:22:17 INFO  [http-nio-8080-exec-3] edu.ucsal.fiadopay.service.payment.PaymentService - Pagamento criado com sucesso paymentId=pay_d2336526-492f-415a-8c9f-46b16110900e status=PENDING
2025-11-21 16:22:17 INFO  [pool-2-thread-1] edu.ucsal.fiadopay.service.payment.PaymentService - Processando webhook para paymentId=pay_d2336526-492f-415a-8c9f-46b16110900e
2025-11-21 16:22:17 INFO  [http-nio-8080-exec-3] edu.ucsal.fiadopay.annotations.logged.LogAspect - [metricas] Executado em 33ms | args=[edu.ucsal.fiadopay.domain.merchant.Merchant@392e95e2, 123e4567-e89b-12d3-a456-426614174000, PaymentRequest[method=CARD, currency=BRL, amount=19990.50, metadataOrderId=order-123, details={installments=3}]]
2025-11-21 16:22:19 WARN  [http-nio-8080-exec-5] edu.ucsal.fiadopay.service.payment.PaymentService - Tentativa de acesso não autorizado paymentId=pay_efd77589-e0d8-4055-84fa-c518558d3fa0 merchantId=1
2025-11-21 16:22:19 WARN  [http-nio-8080-exec-5] org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver - Resolved [org.springframework.web.server.ResponseStatusException: 403 FORBIDDEN "Payment does not exist or does not belong to this merchant."]
2025-11-21 16:22:19 INFO  [pool-2-thread-1] edu.ucsal.fiadopay.service.payment.PaymentService - Agendando entrega de webhook eventId=evt_cc4a03df paymentId=pay_d2336526-492f-415a-8c9f-46b16110900e url=http://localhost:8081/webhooks/payments
2025-11-21 16:22:19 INFO  [pool-2-thread-1] edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService - Webhook agendado: id=1, url=http://localhost:8081/webhooks/payments, payloadSize=176
2025-11-21 16:22:19 INFO  [pool-3-thread-1] edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService - Iniciando tentativa 1 para webhook id=1 (url=http://localhost:8081/webhooks/payments)
2025-11-21 16:22:19 ERROR [pool-3-thread-1] edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService - Erro inesperado no webhook id=1: null
java.net.ConnectException: null
	at java.net.http/jdk.internal.net.http.HttpClientImpl.send(HttpClientImpl.java:955)
	at java.net.http/jdk.internal.net.http.HttpClientFacade.send(HttpClientFacade.java:133)
	at edu.ucsal.fiadopay.service.webhook.WebhookSender.send(WebhookSender.java:23)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.attempt(WebhookDeliveryService.java:56)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.lambda$scheduleDelivery$0(WebhookDeliveryService.java:39)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.net.ConnectException: null
	at java.net.http/jdk.internal.net.http.common.Utils.toConnectException(Utils.java:1065)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.connectAsync(PlainHttpConnection.java:227)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.checkRetryConnect(PlainHttpConnection.java:280)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.lambda$connectAsync$2(PlainHttpConnection.java:238)
	at java.base/java.util.concurrent.CompletableFuture.uniHandle(CompletableFuture.java:934)
	at java.base/java.util.concurrent.CompletableFuture$UniHandle.tryFire(CompletableFuture.java:911)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1773)
	... 3 common frames omitted
Caused by: java.nio.channels.ClosedChannelException: null
	at java.base/sun.nio.ch.SocketChannelImpl.ensureOpen(SocketChannelImpl.java:202)
	at java.base/sun.nio.ch.SocketChannelImpl.beginConnect(SocketChannelImpl.java:786)
	at java.base/sun.nio.ch.SocketChannelImpl.connect(SocketChannelImpl.java:874)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.lambda$connectAsync$1(PlainHttpConnection.java:210)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:571)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.connectAsync(PlainHttpConnection.java:212)
	... 9 common frames omitted
2025-11-21 16:22:19 WARN  [pool-3-thread-1] edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService - Erro – reagendando id=1 para daqui 1000ms
2025-11-21 16:22:20 INFO  [pool-3-thread-1] edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService - Iniciando tentativa 2 para webhook id=1 (url=http://localhost:8081/webhooks/payments)
2025-11-21 16:22:20 ERROR [pool-3-thread-1] edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService - Erro inesperado no webhook id=1: null
java.net.ConnectException: null
	at java.net.http/jdk.internal.net.http.HttpClientImpl.send(HttpClientImpl.java:955)
	at java.net.http/jdk.internal.net.http.HttpClientFacade.send(HttpClientFacade.java:133)
	at edu.ucsal.fiadopay.service.webhook.WebhookSender.send(WebhookSender.java:23)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.attempt(WebhookDeliveryService.java:56)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.attempt(WebhookDeliveryService.java:90)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.lambda$scheduleDelivery$0(WebhookDeliveryService.java:39)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.net.ConnectException: null
	at java.net.http/jdk.internal.net.http.common.Utils.toConnectException(Utils.java:1065)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.connectAsync(PlainHttpConnection.java:227)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.checkRetryConnect(PlainHttpConnection.java:280)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.lambda$connectAsync$2(PlainHttpConnection.java:238)
	at java.base/java.util.concurrent.CompletableFuture.uniHandle(CompletableFuture.java:934)
	at java.base/java.util.concurrent.CompletableFuture$UniHandle.tryFire(CompletableFuture.java:911)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1773)
	... 3 common frames omitted
Caused by: java.nio.channels.ClosedChannelException: null
	at java.base/sun.nio.ch.SocketChannelImpl.ensureOpen(SocketChannelImpl.java:202)
	at java.base/sun.nio.ch.SocketChannelImpl.beginConnect(SocketChannelImpl.java:786)
	at java.base/sun.nio.ch.SocketChannelImpl.connect(SocketChannelImpl.java:874)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.lambda$connectAsync$1(PlainHttpConnection.java:210)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:571)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.connectAsync(PlainHttpConnection.java:212)
	... 9 common frames omitted
2025-11-21 16:22:20 WARN  [pool-3-thread-1] edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService - Erro – reagendando id=1 para daqui 2000ms
2025-11-21 16:22:22 INFO  [pool-3-thread-1] edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService - Iniciando tentativa 3 para webhook id=1 (url=http://localhost:8081/webhooks/payments)
2025-11-21 16:22:22 ERROR [pool-3-thread-1] edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService - Erro inesperado no webhook id=1: null
java.net.ConnectException: null
	at java.net.http/jdk.internal.net.http.HttpClientImpl.send(HttpClientImpl.java:955)
	at java.net.http/jdk.internal.net.http.HttpClientFacade.send(HttpClientFacade.java:133)
	at edu.ucsal.fiadopay.service.webhook.WebhookSender.send(WebhookSender.java:23)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.attempt(WebhookDeliveryService.java:56)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.attempt(WebhookDeliveryService.java:90)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.attempt(WebhookDeliveryService.java:90)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.lambda$scheduleDelivery$0(WebhookDeliveryService.java:39)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.net.ConnectException: null
	at java.net.http/jdk.internal.net.http.common.Utils.toConnectException(Utils.java:1065)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.connectAsync(PlainHttpConnection.java:227)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.checkRetryConnect(PlainHttpConnection.java:280)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.lambda$connectAsync$2(PlainHttpConnection.java:238)
	at java.base/java.util.concurrent.CompletableFuture.uniHandle(CompletableFuture.java:934)
	at java.base/java.util.concurrent.CompletableFuture$UniHandle.tryFire(CompletableFuture.java:911)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1773)
	... 3 common frames omitted
Caused by: java.nio.channels.ClosedChannelException: null
	at java.base/sun.nio.ch.SocketChannelImpl.ensureOpen(SocketChannelImpl.java:202)
	at java.base/sun.nio.ch.SocketChannelImpl.beginConnect(SocketChannelImpl.java:786)
	at java.base/sun.nio.ch.SocketChannelImpl.connect(SocketChannelImpl.java:874)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.lambda$connectAsync$1(PlainHttpConnection.java:210)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:571)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.connectAsync(PlainHttpConnection.java:212)
	... 9 common frames omitted
2025-11-21 16:22:22 WARN  [pool-3-thread-1] edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService - Erro – reagendando id=1 para daqui 3000ms
2025-11-21 16:22:25 INFO  [pool-3-thread-1] edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService - Iniciando tentativa 4 para webhook id=1 (url=http://localhost:8081/webhooks/payments)
2025-11-21 16:22:25 ERROR [pool-3-thread-1] edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService - Erro inesperado no webhook id=1: null
java.net.ConnectException: null
	at java.net.http/jdk.internal.net.http.HttpClientImpl.send(HttpClientImpl.java:955)
	at java.net.http/jdk.internal.net.http.HttpClientFacade.send(HttpClientFacade.java:133)
	at edu.ucsal.fiadopay.service.webhook.WebhookSender.send(WebhookSender.java:23)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.attempt(WebhookDeliveryService.java:56)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.attempt(WebhookDeliveryService.java:90)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.attempt(WebhookDeliveryService.java:90)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.attempt(WebhookDeliveryService.java:90)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.lambda$scheduleDelivery$0(WebhookDeliveryService.java:39)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.net.ConnectException: null
	at java.net.http/jdk.internal.net.http.common.Utils.toConnectException(Utils.java:1065)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.connectAsync(PlainHttpConnection.java:227)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.checkRetryConnect(PlainHttpConnection.java:280)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.lambda$connectAsync$2(PlainHttpConnection.java:238)
	at java.base/java.util.concurrent.CompletableFuture.uniHandle(CompletableFuture.java:934)
	at java.base/java.util.concurrent.CompletableFuture$UniHandle.tryFire(CompletableFuture.java:911)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1773)
	... 3 common frames omitted
Caused by: java.nio.channels.ClosedChannelException: null
	at java.base/sun.nio.ch.SocketChannelImpl.ensureOpen(SocketChannelImpl.java:202)
	at java.base/sun.nio.ch.SocketChannelImpl.beginConnect(SocketChannelImpl.java:786)
	at java.base/sun.nio.ch.SocketChannelImpl.connect(SocketChannelImpl.java:874)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.lambda$connectAsync$1(PlainHttpConnection.java:210)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:571)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.connectAsync(PlainHttpConnection.java:212)
	... 9 common frames omitted
2025-11-21 16:22:25 WARN  [pool-3-thread-1] edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService - Erro – reagendando id=1 para daqui 4000ms
2025-11-21 16:22:29 INFO  [pool-3-thread-1] edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService - Iniciando tentativa 5 para webhook id=1 (url=http://localhost:8081/webhooks/payments)
2025-11-21 16:22:29 ERROR [pool-3-thread-1] edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService - Erro inesperado no webhook id=1: null
java.net.ConnectException: null
	at java.net.http/jdk.internal.net.http.HttpClientImpl.send(HttpClientImpl.java:955)
	at java.net.http/jdk.internal.net.http.HttpClientFacade.send(HttpClientFacade.java:133)
	at edu.ucsal.fiadopay.service.webhook.WebhookSender.send(WebhookSender.java:23)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.attempt(WebhookDeliveryService.java:56)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.attempt(WebhookDeliveryService.java:90)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.attempt(WebhookDeliveryService.java:90)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.attempt(WebhookDeliveryService.java:90)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.attempt(WebhookDeliveryService.java:90)
	at edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService.lambda$scheduleDelivery$0(WebhookDeliveryService.java:39)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.net.ConnectException: null
	at java.net.http/jdk.internal.net.http.common.Utils.toConnectException(Utils.java:1065)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.connectAsync(PlainHttpConnection.java:227)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.checkRetryConnect(PlainHttpConnection.java:280)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.lambda$connectAsync$2(PlainHttpConnection.java:238)
	at java.base/java.util.concurrent.CompletableFuture.uniHandle(CompletableFuture.java:934)
	at java.base/java.util.concurrent.CompletableFuture$UniHandle.tryFire(CompletableFuture.java:911)
	at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1773)
	... 3 common frames omitted
Caused by: java.nio.channels.ClosedChannelException: null
	at java.base/sun.nio.ch.SocketChannelImpl.ensureOpen(SocketChannelImpl.java:202)
	at java.base/sun.nio.ch.SocketChannelImpl.beginConnect(SocketChannelImpl.java:786)
	at java.base/sun.nio.ch.SocketChannelImpl.connect(SocketChannelImpl.java:874)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.lambda$connectAsync$1(PlainHttpConnection.java:210)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:571)
	at java.net.http/jdk.internal.net.http.PlainHttpConnection.connectAsync(PlainHttpConnection.java:212)
	... 9 common frames omitted
2025-11-21 16:22:29 ERROR [pool-3-thread-1] edu.ucsal.fiadopay.service.webhook.WebhookDeliveryService - Webhook id=1 falhou definitivamente após 5 tentativas.
2025-11-21 16:41:06 INFO  [SpringApplicationShutdownHook] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-21 16:41:06 INFO  [tomcat-shutdown] org.springframework.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-21 16:41:06 INFO  [SpringApplicationShutdownHook] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 16:41:06 WARN  [SpringApplicationShutdownHook] org.springframework.beans.factory.support.DisposableBeanAdapter - Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-232]
2025-11-21 16:41:06 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-11-21 16:41:06 INFO  [SpringApplicationShutdownHook] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-11-21 16:41:10 INFO  [background-preinit] org.hibernate.validator.internal.util.Version - HV000001: Hibernate Validator 8.0.3.Final
2025-11-21 16:41:10 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Starting FiadoPayApplication using Java 21.0.8 with PID 25715 (/home/andre/Documents/fiadopay-main/target/classes started by andre in /home/andre/Documents/fiadopay-main)
2025-11-21 16:41:10 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - No active profile set, falling back to 1 default profile: "default"
2025-11-21 16:41:10 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
2025-11-21 16:41:10 INFO  [restartedMain] org.springframework.boot.devtools.env.DevToolsPropertyDefaultsPostProcessor - For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
2025-11-21 16:41:11 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-11-21 16:41:11 INFO  [restartedMain] org.springframework.data.repository.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 67 ms. Found 4 JPA repository interfaces.
2025-11-21 16:41:12 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-21 16:41:12 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2025-11-21 16:41:12 INFO  [restartedMain] org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-11-21 16:41:12 INFO  [restartedMain] org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-21 16:41:12 INFO  [restartedMain] org.apache.catalina.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-11-21 16:41:12 INFO  [restartedMain] org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2263 ms
2025-11-21 16:41:12 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-11-21 16:41:12 INFO  [restartedMain] com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:fiadopay user=SA
2025-11-21 16:41:12 INFO  [restartedMain] com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-11-21 16:41:12 INFO  [restartedMain] org.hibernate.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-11-21 16:41:12 INFO  [restartedMain] org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.33.Final
2025-11-21 16:41:12 INFO  [restartedMain] org.hibernate.cache.internal.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-11-21 16:41:13 INFO  [restartedMain] org.springframework.orm.jpa.persistenceunit.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-11-21 16:41:13 INFO  [restartedMain] org.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.3.232
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-11-21 16:41:14 INFO  [restartedMain] org.hibernate.engine.transaction.jta.platform.internal.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-11-21 16:41:14 INFO  [restartedMain] org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-11-21 16:41:14 INFO  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeAuthenticationProviderBeanManagerConfigurer$InitializeAuthenticationProviderManagerConfigurer - Global AuthenticationManager configured with AuthenticationProvider bean with name authenticationProvider
2025-11-21 16:41:14 WARN  [restartedMain] org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with an AuthenticationProvider bean. UserDetailsService beans will not be used by Spring Security for automatically configuring username/password login. Consider removing the AuthenticationProvider bean. Alternatively, consider using the UserDetailsService in a manually instantiated DaoAuthenticationProvider. If the current configuration is intentional, to turn off this warning, increase the logging level of 'org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer' to ERROR
2025-11-21 16:41:14 WARN  [restartedMain] org.springframework.boot.autoconfigure.orm.jpa.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-11-21 16:41:15 INFO  [restartedMain] org.springframework.boot.autoconfigure.h2.H2ConsoleAutoConfiguration - H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:fiadopay'
2025-11-21 16:41:15 INFO  [restartedMain] org.springframework.boot.devtools.autoconfigure.OptionalLiveReloadServer - LiveReload server is running on port 35729
2025-11-21 16:41:15 INFO  [restartedMain] org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2025-11-21 16:41:15 INFO  [restartedMain] org.springframework.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-11-21 16:41:15 INFO  [restartedMain] edu.ucsal.fiadopay.FiadoPayApplication - Started FiadoPayApplication in 6.068 seconds (process running for 6.584)
